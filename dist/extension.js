var h=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var mt=h(yt=>{var{Uri:Il,workspace:D}=require("vscode"),z=require("path"),Cl=require("fs");function Ll(t){let e=Rl(t),s=D.asRelativePath(t).replace(z.sep,"/");e.startsWith.length>0&&(s=s.substring(e.startsWith.length));let i=s.split("/");if(i.length<2)return e.namespace;let n=i.slice(0,i.length-1).map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join("\\");return e.namespace===""?n:n===""?e.namespace:e.namespace+"\\"+n}function Sl(t){let s=D.getConfiguration("phpcompanion").get("class.composerJson",null);return!s||s.length<1?null:D.getWorkspaceFolder(Il.file(t)).uri.fsPath+z.sep+s}function Rl(t){let s={namespace:D.getConfiguration("phpcompanion").get("class.vendor",""),startsWith:""},i=Ol(Sl(t));if(!i)return s;let n=D.asRelativePath(t).replace(z.sep,"/"),r=["autoload","autoload-dev"];for(let o=0;o<r.length;o++){let a=r[o];if(i[a]&&i[a]["psr-4"])for(let c in i[a]["psr-4"]){let l=i[a]["psr-4"][c];if(n.startsWith(l))return c.endsWith("\\")&&(c=c.substring(0,c.length-1)),l.endsWith("/")||(l+="/"),{namespace:c,startsWith:l}}}return n.startsWith("src/")?s.startsWith="src/":n.startsWith("tests/")?s.startsWith="tests/":s.namespace!==""&&n.startsWith("app/")&&(s.startsWith="app/"),s}function Ol(t){let e="{}";try{e=Cl.readFileSync(t)}catch{return null}let s=JSON.parse(e);return s||null}yt.getNamespaceFromPath=Ll});var X=h(G=>{var{Position:bl,Selection:gl,window:j}=require("vscode");function Dl(){return j.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0})}function vl(t){return j.showInputBox({prompt:t})}function wl(t,e=0){let s=new bl(t,e);j.activeTextEditor.selections=[new gl(s,s)]}G.askFolder=Dl;G.ask=vl;G.moveCursorTo=wl});var St=h(st=>{var{Uri:It,window:Z,workspace:v}=require("vscode"),{getNamespaceFromPath:Ct}=mt(),tt=X();function Ul(){let t=Z.activeTextEditor;t.edit(e=>{e.replace(t.selection,"namespace "+Ct(t.document.fileName)+";")})}function Lt(t){if(!t||!t.fsPath){tt.askFolder().then(e=>{e!==void 0&&Lt(It.parse(e))});return}tt.ask("Class name").then(e=>{if(e.toLowerCase().endsWith(".php")&&(e=e.substring(0,e.length-4)),e===void 0||e.length<1)return;let s=Ml(e),i=t.fsPath+"/"+e+".php";Pl(i,Fl(e,Ct(i),s))})}function Pl(t,e){let s=It.file(t);v.fs.stat(s).then(()=>{Z.showErrorMessage('File "'+v.asRelativePath(s)+'" already exists')},()=>{v.fs.writeFile(s,new TextEncoder().encode(e)).then(()=>{v.openTextDocument(s).then(i=>Z.showTextDocument(i).then(n=>tt.moveCursorTo(n.document.lineCount-3,4)))})})}function Fl(t,e,s){let i="",n="";return s=="test"&&(s="class",i=`use PHPUnit\\Framework\\TestCase;

`,n=" extends TestCase"),s=="class"&&et("class.insertFinal")&&(s="final class"),`<?php

`+(et("class.insertStrict")?`declare(strict_types=1);

`:"")+"namespace "+e+`;

`+i+s+" "+t+n+`
{
    
}
`}function Ml(t){return J(t,"class.detectTestCase","Test")?"test":J(t,"class.detectInterface","Interface")?"interface":J(t,"class.detectTrait","Trait")?"trait":"class"}function J(t,e,s){return et(e)&&t!==s&&t.endsWith(s)}function et(t){return v.getConfiguration("phpcompanion").get(t,!0)}st.createPHPFile=Lt;st.replaceSelectionWithNamespace=Ul});var Ot=h((J_,Rt)=>{"use strict";Rt.exports={attributeIndex:0,attributeListDepth:{},matchST_ATTRIBUTE(){let t=this.input();if(this.is_WHITESPACE()){do t=this.input();while(this.is_WHITESPACE());return this.unput(1),null}switch(t){case"]":return this.attributeListDepth[this.attributeIndex]===0?(delete this.attributeListDepth[this.attributeIndex],this.attributeIndex--,this.popState()):this.attributeListDepth[this.attributeIndex]--,"]";case"(":case")":case":":case"=":case"|":case"&":case"^":case"-":case"+":case"*":case"%":case"~":case"<":case">":case"!":case".":return this.consume_TOKEN();case"[":return this.attributeListDepth[this.attributeIndex]++,"[";case",":return",";case'"':return this.ST_DOUBLE_QUOTES();case"'":return this.T_CONSTANT_ENCAPSED_STRING();case"/":return this._input[this.offset]==="/"?this.T_COMMENT():this._input[this.offset]==="*"?(this.input(),this.T_DOC_COMMENT()):this.consume_TOKEN()}if(this.is_LABEL_START()||t==="\\"){for(;this.offset<this.size;){let e=this.input();if(!(this.is_LABEL()||e==="\\")){e&&this.unput(1);break}}return this.T_STRING()}else if(this.is_NUM())return this.consume_NUM();throw new Error(`Bad terminal sequence "${t}" at line ${this.yylineno} (offset ${this.offset})`)}}});var gt=h((Z_,bt)=>{"use strict";bt.exports={T_COMMENT(){for(;this.offset<this.size;){let t=this.input();if(t===`
`||t==="\r")return this.tok.T_COMMENT;if(t==="?"&&!this.aspTagMode&&this._input[this.offset]===">")return this.unput(1),this.tok.T_COMMENT;if(t==="%"&&this.aspTagMode&&this._input[this.offset]===">")return this.unput(1),this.tok.T_COMMENT}return this.tok.T_COMMENT},T_DOC_COMMENT(){let t=this.input(),e=this.tok.T_COMMENT;if(t==="*"){if(t=this.input(),this.is_WHITESPACE()&&(e=this.tok.T_DOC_COMMENT),t==="/")return e;this.unput(1)}for(;this.offset<this.size;)if(t=this.input(),t==="*"&&this._input[this.offset]==="/"){this.input();break}return e}}});var vt=h((tu,Dt)=>{"use strict";Dt.exports={nextINITIAL(){return this.conditionStack.length>1&&this.conditionStack[this.conditionStack.length-1]==="INITIAL"?this.popState():this.begin("ST_IN_SCRIPTING"),this},matchINITIAL(){for(;this.offset<this.size;){let t=this.input();if(t=="<"){if(t=this.ahead(1),t=="?"){if(this.tryMatch("?=")){this.unput(1).appendToken(this.tok.T_OPEN_TAG_WITH_ECHO,3).nextINITIAL();break}else if(this.tryMatchCaseless("?php")&&(t=this._input[this.offset+4],t===" "||t==="	"||t===`
`||t==="\r")){this.unput(1).appendToken(this.tok.T_OPEN_TAG,6).nextINITIAL();break}if(this.short_tags){this.unput(1).appendToken(this.tok.T_OPEN_TAG,2).nextINITIAL();break}}else if(this.asp_tags&&t=="%")if(this.tryMatch("%=")){this.aspTagMode=!0,this.unput(1).appendToken(this.tok.T_OPEN_TAG_WITH_ECHO,3).nextINITIAL();break}else{this.aspTagMode=!0,this.unput(1).appendToken(this.tok.T_OPEN_TAG,2).nextINITIAL();break}}}return this.yytext.length>0?this.tok.T_INLINE_HTML:!1}}});var Pt=h((eu,Ut)=>{"use strict";var H=10,wt="2147483648";process.arch=="x64"&&(H=19,wt="9223372036854775808");Ut.exports={consume_NUM(){let t=this.yytext[0],e=t===".";if(t==="0")if(t=this.input(),t==="x"||t==="X"){if(t=this.input(),t!=="_"&&this.is_HEX())return this.consume_HNUM();this.unput(t?2:1)}else if(t==="b"||t==="B"){if(t=this.input(),t!=="_"&&t==="0"||t==="1")return this.consume_BNUM();this.unput(t?2:1)}else if(t==="o"||t==="O"){if(t=this.input(),t!=="_"&&this.is_OCTAL())return this.consume_ONUM();this.unput(t?2:1)}else this.is_NUM()||t&&this.unput(1);for(;this.offset<this.size;){let s=t;if(t=this.input(),t==="_"){if(s==="_"){this.unput(2);break}if(s==="."){this.unput(1);break}if(s==="e"||s==="E"){this.unput(2);break}}else if(t==="."){if(e){this.unput(1);break}if(s==="_"){this.unput(2);break}e=!0;continue}else if(t==="e"||t==="E"){if(s==="_"){this.unput(1);break}let i=2;if(t=this.input(),(t==="+"||t==="-")&&(i=3,t=this.input()),this.is_NUM_START())return this.consume_LNUM(),this.tok.T_DNUMBER;this.unput(t?i:i-1);break}if(!this.is_NUM()){t&&this.unput(1);break}}return e?this.tok.T_DNUMBER:this.yytext.length<H-1?this.tok.T_LNUMBER:this.yytext.length<H||this.yytext.length==H&&this.yytext<wt?this.tok.T_LNUMBER:this.tok.T_DNUMBER},consume_HNUM(){for(;this.offset<this.size;){let t=this.input();if(!this.is_HEX()){t&&this.unput(1);break}}return this.tok.T_LNUMBER},consume_LNUM(){for(;this.offset<this.size;){let t=this.input();if(!this.is_NUM()){t&&this.unput(1);break}}return this.tok.T_LNUMBER},consume_BNUM(){let t;for(;this.offset<this.size;)if(t=this.input(),t!=="0"&&t!=="1"&&t!=="_"){t&&this.unput(1);break}return this.tok.T_LNUMBER},consume_ONUM(){for(;this.offset<this.size;){let t=this.input();if(!this.is_OCTAL()){t&&this.unput(1);break}}return this.tok.T_LNUMBER}}});var Mt=h((su,Ft)=>{"use strict";Ft.exports={matchST_LOOKING_FOR_PROPERTY(){let t=this.input();if(t==="-"){if(t=this.input(),t===">")return this.tok.T_OBJECT_OPERATOR;t&&this.unput(1)}else{if(this.is_WHITESPACE())return this.tok.T_WHITESPACE;if(this.is_LABEL_START())return this.consume_LABEL(),this.popState(),this.tok.T_STRING}return this.popState(),t&&this.unput(1),!1},matchST_LOOKING_FOR_VARNAME(){let t=this.input();if(this.popState(),this.begin("ST_IN_SCRIPTING"),this.is_LABEL_START()){if(this.consume_LABEL(),t=this.input(),t==="["||t==="}")return this.unput(1),this.tok.T_STRING_VARNAME;this.unput(this.yytext.length)}else t&&this.unput(1);return!1},matchST_VAR_OFFSET(){let t=this.input();if(this.is_NUM_START())return this.consume_NUM(),this.tok.T_NUM_STRING;if(t==="]")return this.popState(),"]";if(t==="$"){if(this.input(),this.is_LABEL_START())return this.consume_LABEL(),this.tok.T_VARIABLE;throw new Error("Unexpected terminal")}else{if(this.is_LABEL_START())return this.consume_LABEL(),this.tok.T_STRING;if(this.is_WHITESPACE()||t==="\\"||t==="'"||t==="#")return this.tok.T_ENCAPSED_AND_WHITESPACE;if(t==="["||t==="{"||t==="}"||t==='"'||t==="`"||this.is_TOKEN())return t;throw new Error("Unexpected terminal")}}}});var Bt=h((iu,qt)=>{"use strict";qt.exports={matchST_IN_SCRIPTING(){let t=this.input();switch(t){case" ":case"	":case`
`:case"\r":case`\r
`:return this.T_WHITESPACE();case"#":return this.version>=800&&this._input[this.offset]==="["?(this.input(),this.attributeListDepth[++this.attributeIndex]=0,this.begin("ST_ATTRIBUTE"),this.tok.T_ATTRIBUTE):this.T_COMMENT();case"/":return this._input[this.offset]==="/"?this.T_COMMENT():this._input[this.offset]==="*"?(this.input(),this.T_DOC_COMMENT()):this.consume_TOKEN();case"'":return this.T_CONSTANT_ENCAPSED_STRING();case'"':return this.ST_DOUBLE_QUOTES();case"`":return this.begin("ST_BACKQUOTE"),"`";case"?":if(!this.aspTagMode&&this.tryMatch(">")){this.input();let e=this._input[this.offset];return(e===`
`||e==="\r")&&this.input(),this.conditionStack.length>1&&this.begin("INITIAL"),this.tok.T_CLOSE_TAG}return this.consume_TOKEN();case"%":return this.aspTagMode&&this._input[this.offset]===">"?(this.input(),t=this._input[this.offset],(t===`
`||t==="\r")&&this.input(),this.aspTagMode=!1,this.conditionStack.length>1&&this.begin("INITIAL"),this.tok.T_CLOSE_TAG):this.consume_TOKEN();case"{":return this.begin("ST_IN_SCRIPTING"),"{";case"}":return this.conditionStack.length>2&&this.popState(),"}";default:if(t==="."){if(t=this.input(),this.is_NUM_START())return this.consume_NUM();t&&this.unput(1)}if(this.is_NUM_START())return this.consume_NUM();if(this.is_LABEL_START())return this.consume_LABEL().T_STRING();if(this.is_TOKEN())return this.consume_TOKEN()}throw new Error('Bad terminal sequence "'+t+'" at line '+this.yylineno+" (offset "+this.offset+")")},T_WHITESPACE(){for(;this.offset<this.size;){let t=this.input();if(!(t===" "||t==="	"||t===`
`||t==="\r")){t&&this.unput(1);break}}return this.tok.T_WHITESPACE}}});var Kt=h((nu,Ht)=>{"use strict";var S=[`
`,"\r"],Gt=[`
`,"\r",";"],ql=Gt.concat(["	"," ",",","]",")","/","=","!","."]);Ht.exports={T_CONSTANT_ENCAPSED_STRING(){let t;for(;this.offset<this.size;)if(t=this.input(),t=="\\")this.input();else if(t=="'")break;return this.tok.T_CONSTANT_ENCAPSED_STRING},is_HEREDOC(){let t=this.offset;if(this._input[this.offset-1]==="<"&&this._input[this.offset]==="<"&&this._input[this.offset+1]==="<"){if(this.offset+=3,this.is_TABSPACE())for(;this.offset<this.size&&(this.offset++,!!this.is_TABSPACE()););let e=this._input[this.offset-1];if(e==="'"||e==='"'?this.offset++:e=null,this.is_LABEL_START()){let s=this.offset-1;for(;this.offset<this.size&&(this.offset++,!!this.is_LABEL()););let i=this._input.substring(s,this.offset-1);if((!e||e===this._input[this.offset-1])&&(e&&this.offset++,S.includes(this._input[this.offset-1])))return this.heredoc_label.label=i,this.heredoc_label.length=i.length,this.heredoc_label.finished=!1,s=this.offset-t,this.offset=t,this.consume(s),e==="'"?this.begin("ST_NOWDOC"):this.begin("ST_HEREDOC"),this.prematch_ENDOFDOC(),this.tok.T_START_HEREDOC}}return this.offset=t,!1},ST_DOUBLE_QUOTES(){let t;for(;this.offset<this.size;)if(t=this.input(),t=="\\")this.input();else{if(t=='"')break;if(t=="$"){if(t=this.input(),t=="{"||this.is_LABEL_START()){this.unput(2);break}t&&this.unput(1)}else if(t=="{"){if(t=this.input(),t=="$"){this.unput(2);break}t&&this.unput(1)}}if(t=='"')return this.tok.T_CONSTANT_ENCAPSED_STRING;{let e=1;return(this.yytext[0]==="b"||this.yytext[0]==="B")&&(e=2),this.yytext.length>2&&this.appendToken(this.tok.T_ENCAPSED_AND_WHITESPACE,this.yytext.length-e),this.unput(this.yytext.length-e),this.begin("ST_DOUBLE_QUOTES"),this.yytext}},isDOC_MATCH(t,e){let s=this._input[t-2];if(!S.includes(s))return!1;let i=!1,n=!1,r=0,o=this._input[t-1];if(this.version>=703){for(;o==="	"||o===" ";)o===" "?i=!0:o==="	"&&(n=!0),o=this._input[t+r],r++;if(t=t+r,S.includes(this._input[t-1]))return!1}if(this._input.substring(t-1,t-1+this.heredoc_label.length)===this.heredoc_label.label){let a=this._input[t-1+this.heredoc_label.length];if((this.version>=703?ql:Gt).includes(a)){if(e){if(this.consume(r),i&&n)throw new Error("Parse error:  mixing spaces and tabs in ending marker at line "+this.yylineno+" (offset "+this.offset+")")}else this.heredoc_label.indentation=r,this.heredoc_label.indentation_uses_spaces=i,this.heredoc_label.first_encaps_node=!0;return!0}}return!1},prematch_ENDOFDOC(){this.heredoc_label.indentation_uses_spaces=!1,this.heredoc_label.indentation=0,this.heredoc_label.first_encaps_node=!0;let t=this.offset+1;for(;t<this._input.length;){if(this.isDOC_MATCH(t,!1))return;if(!S.includes(this._input[t-1]))for(;!S.includes(this._input[t++])&&t<this._input.length;);t++}},matchST_NOWDOC(){if(this.isDOC_MATCH(this.offset,!0))return this.consume(this.heredoc_label.length),this.popState(),this.tok.T_END_HEREDOC;let t=this._input[this.offset-1];for(;this.offset<this.size;)if(S.includes(t)){if(t=this.input(),this.isDOC_MATCH(this.offset,!0))return this.unput(1).popState(),this.appendToken(this.tok.T_END_HEREDOC,this.heredoc_label.length),this.tok.T_ENCAPSED_AND_WHITESPACE}else t=this.input();return this.tok.T_ENCAPSED_AND_WHITESPACE},matchST_HEREDOC(){let t=this.input();if(this.isDOC_MATCH(this.offset,!0))return this.consume(this.heredoc_label.length-1),this.popState(),this.tok.T_END_HEREDOC;for(;this.offset<this.size;)if(t==="\\"&&(t=this.input(),S.includes(t)||(t=this.input())),S.includes(t)){if(t=this.input(),this.isDOC_MATCH(this.offset,!0))return this.unput(1).popState(),this.appendToken(this.tok.T_END_HEREDOC,this.heredoc_label.length),this.tok.T_ENCAPSED_AND_WHITESPACE}else if(t==="$"){if(t=this.input(),t==="{")return this.begin("ST_LOOKING_FOR_VARNAME"),this.yytext.length>2?(this.appendToken(this.tok.T_DOLLAR_OPEN_CURLY_BRACES,2),this.unput(2),this.tok.T_ENCAPSED_AND_WHITESPACE):this.tok.T_DOLLAR_OPEN_CURLY_BRACES;if(this.is_LABEL_START()){let e=this.offset,s=this.consume_VARIABLE();return this.yytext.length>this.offset-e+2?(this.appendToken(s,this.offset-e+2),this.unput(this.offset-e+2),this.tok.T_ENCAPSED_AND_WHITESPACE):s}}else if(t==="{"){if(t=this.input(),t==="$")return this.begin("ST_IN_SCRIPTING"),this.yytext.length>2?(this.appendToken(this.tok.T_CURLY_OPEN,1),this.unput(2),this.tok.T_ENCAPSED_AND_WHITESPACE):(this.unput(1),this.tok.T_CURLY_OPEN)}else t=this.input();return this.tok.T_ENCAPSED_AND_WHITESPACE},consume_VARIABLE(){this.consume_LABEL();let t=this.input();if(t=="[")return this.unput(1),this.begin("ST_VAR_OFFSET"),this.tok.T_VARIABLE;if(t==="-"){if(this.input()===">")return this.input(),this.is_LABEL_START()&&this.begin("ST_LOOKING_FOR_PROPERTY"),this.unput(3),this.tok.T_VARIABLE;this.unput(2)}else t&&this.unput(1);return this.tok.T_VARIABLE},matchST_BACKQUOTE(){let t=this.input();if(t==="$"){if(t=this.input(),t==="{")return this.begin("ST_LOOKING_FOR_VARNAME"),this.tok.T_DOLLAR_OPEN_CURLY_BRACES;if(this.is_LABEL_START())return this.consume_VARIABLE()}else if(t==="{"){if(this._input[this.offset]==="$")return this.begin("ST_IN_SCRIPTING"),this.tok.T_CURLY_OPEN}else if(t==="`")return this.popState(),"`";for(;this.offset<this.size;){if(t==="\\")this.input();else if(t==="`"){this.unput(1),this.popState(),this.appendToken("`",1);break}else if(t==="$"){if(t=this.input(),t==="{")return this.begin("ST_LOOKING_FOR_VARNAME"),this.yytext.length>2?(this.appendToken(this.tok.T_DOLLAR_OPEN_CURLY_BRACES,2),this.unput(2),this.tok.T_ENCAPSED_AND_WHITESPACE):this.tok.T_DOLLAR_OPEN_CURLY_BRACES;if(this.is_LABEL_START()){let e=this.offset,s=this.consume_VARIABLE();return this.yytext.length>this.offset-e+2?(this.appendToken(s,this.offset-e+2),this.unput(this.offset-e+2),this.tok.T_ENCAPSED_AND_WHITESPACE):s}continue}else if(t==="{"){if(t=this.input(),t==="$")return this.begin("ST_IN_SCRIPTING"),this.yytext.length>2?(this.appendToken(this.tok.T_CURLY_OPEN,1),this.unput(2),this.tok.T_ENCAPSED_AND_WHITESPACE):(this.unput(1),this.tok.T_CURLY_OPEN);continue}t=this.input()}return this.tok.T_ENCAPSED_AND_WHITESPACE},matchST_DOUBLE_QUOTES(){let t=this.input();if(t==="$"){if(t=this.input(),t==="{")return this.begin("ST_LOOKING_FOR_VARNAME"),this.tok.T_DOLLAR_OPEN_CURLY_BRACES;if(this.is_LABEL_START())return this.consume_VARIABLE()}else if(t==="{"){if(this._input[this.offset]==="$")return this.begin("ST_IN_SCRIPTING"),this.tok.T_CURLY_OPEN}else if(t==='"')return this.popState(),'"';for(;this.offset<this.size;){if(t==="\\")this.input();else if(t==='"'){this.unput(1),this.popState(),this.appendToken('"',1);break}else if(t==="$"){if(t=this.input(),t==="{")return this.begin("ST_LOOKING_FOR_VARNAME"),this.yytext.length>2?(this.appendToken(this.tok.T_DOLLAR_OPEN_CURLY_BRACES,2),this.unput(2),this.tok.T_ENCAPSED_AND_WHITESPACE):this.tok.T_DOLLAR_OPEN_CURLY_BRACES;if(this.is_LABEL_START()){let e=this.offset,s=this.consume_VARIABLE();return this.yytext.length>this.offset-e+2?(this.appendToken(s,this.offset-e+2),this.unput(this.offset-e+2),this.tok.T_ENCAPSED_AND_WHITESPACE):s}t&&this.unput(1)}else if(t==="{"){if(t=this.input(),t==="$")return this.begin("ST_IN_SCRIPTING"),this.yytext.length>2?(this.appendToken(this.tok.T_CURLY_OPEN,1),this.unput(2),this.tok.T_ENCAPSED_AND_WHITESPACE):(this.unput(1),this.tok.T_CURLY_OPEN);t&&this.unput(1)}t=this.input()}return this.tok.T_ENCAPSED_AND_WHITESPACE}}});var Wt=h((ru,Vt)=>{"use strict";Vt.exports={T_STRING(){let t=this.yytext.toLowerCase(),e=this.keywords[t];if(typeof e!="number"){if(t==="yield")this.version>=700&&this.tryMatch(" from")?(this.consume(5),e=this.tok.T_YIELD_FROM):e=this.tok.T_YIELD;else if(e=this.tok.T_STRING,t==="b"||t==="B"){let s=this.input();if(s==='"')return this.ST_DOUBLE_QUOTES();if(s==="'")return this.T_CONSTANT_ENCAPSED_STRING();s&&this.unput(1)}}if(e===this.tok.T_ENUM){if(this.version<801)return this.tok.T_STRING;let s=this.offset,i=this.input();for(;i==" ";)i=this.input();let n=!1;if(this.is_LABEL_START()){for(;this.is_LABEL();)i+=this.input();let r=i.slice(0,-1).toLowerCase();n=r!=="extends"&&r!=="implements"}return this.unput(this.offset-s),n?this.tok.T_ENUM:this.tok.T_STRING}if(this.offset<this.size&&e!==this.tok.T_YIELD_FROM){let s=this.input();if(s==="\\"){e=t==="namespace"?this.tok.T_NAME_RELATIVE:this.tok.T_NAME_QUALIFIED;do{if(this._input[this.offset]==="{"){this.input();break}this.consume_LABEL(),s=this.input()}while(s==="\\")}s&&this.unput(1)}return e},consume_TOKEN(){let t=this._input[this.offset-1],e=this.tokenTerminals[t];return e?e.apply(this,[]):this.yytext},tokenTerminals:{$(){return this.offset++,this.is_LABEL_START()?(this.offset--,this.consume_LABEL(),this.tok.T_VARIABLE):(this.offset--,"$")},"-"(){let t=this._input[this.offset];return t===">"?(this.begin("ST_LOOKING_FOR_PROPERTY").input(),this.tok.T_OBJECT_OPERATOR):t==="-"?(this.input(),this.tok.T_DEC):t==="="?(this.input(),this.tok.T_MINUS_EQUAL):"-"},"\\"(){if(this.offset<this.size)if(this.input(),this.is_LABEL_START()){let t;do{if(this._input[this.offset]==="{"){this.input();break}this.consume_LABEL(),t=this.input()}while(t==="\\");return this.unput(1),this.tok.T_NAME_FULLY_QUALIFIED}else this.unput(1);return this.tok.T_NS_SEPARATOR},"/"(){return this._input[this.offset]==="="?(this.input(),this.tok.T_DIV_EQUAL):"/"},":"(){return this._input[this.offset]===":"?(this.input(),this.tok.T_DOUBLE_COLON):":"},"("(){let t=this.offset;if(this.input(),this.is_TABSPACE()&&this.consume_TABSPACE().input(),this.is_LABEL_START()){let e=this.yytext.length;this.consume_LABEL();let s=this.yytext.substring(e-1).toLowerCase(),i=this.castKeywords[s];if(typeof i=="number"&&(this.input(),this.is_TABSPACE()&&this.consume_TABSPACE().input(),this._input[this.offset-1]===")"))return i}return this.unput(this.offset-t),"("},"="(){let t=this._input[this.offset];return t===">"?(this.input(),this.tok.T_DOUBLE_ARROW):t==="="?this._input[this.offset+1]==="="?(this.consume(2),this.tok.T_IS_IDENTICAL):(this.input(),this.tok.T_IS_EQUAL):"="},"+"(){let t=this._input[this.offset];return t==="+"?(this.input(),this.tok.T_INC):t==="="?(this.input(),this.tok.T_PLUS_EQUAL):"+"},"!"(){return this._input[this.offset]==="="?this._input[this.offset+1]==="="?(this.consume(2),this.tok.T_IS_NOT_IDENTICAL):(this.input(),this.tok.T_IS_NOT_EQUAL):"!"},"?"(){return this.version>=700&&this._input[this.offset]==="?"?this.version>=704&&this._input[this.offset+1]==="="?(this.consume(2),this.tok.T_COALESCE_EQUAL):(this.input(),this.tok.T_COALESCE):this.version>=800&&this._input[this.offset]==="-"&&this._input[this.offset+1]===">"?(this.consume(1),this.begin("ST_LOOKING_FOR_PROPERTY").input(),this.tok.T_NULLSAFE_OBJECT_OPERATOR):"?"},"<"(){let t=this._input[this.offset];return t==="<"?(t=this._input[this.offset+1],t==="="?(this.consume(2),this.tok.T_SL_EQUAL):t==="<"&&this.is_HEREDOC()?this.tok.T_START_HEREDOC:(this.input(),this.tok.T_SL)):t==="="?(this.input(),this.version>=700&&this._input[this.offset]===">"?(this.input(),this.tok.T_SPACESHIP):this.tok.T_IS_SMALLER_OR_EQUAL):t===">"?(this.input(),this.tok.T_IS_NOT_EQUAL):"<"},">"(){let t=this._input[this.offset];return t==="="?(this.input(),this.tok.T_IS_GREATER_OR_EQUAL):t===">"?(t=this._input[this.offset+1],t==="="?(this.consume(2),this.tok.T_SR_EQUAL):(this.input(),this.tok.T_SR)):">"},"*"(){let t=this._input[this.offset];return t==="="?(this.input(),this.tok.T_MUL_EQUAL):t==="*"?(this.input(),this._input[this.offset]==="="?(this.input(),this.tok.T_POW_EQUAL):this.tok.T_POW):"*"},"."(){let t=this._input[this.offset];return t==="="?(this.input(),this.tok.T_CONCAT_EQUAL):t==="."&&this._input[this.offset+1]==="."?(this.consume(2),this.tok.T_ELLIPSIS):"."},"%"(){return this._input[this.offset]==="="?(this.input(),this.tok.T_MOD_EQUAL):"%"},"&"(){let t=this._input[this.offset];return t==="="?(this.input(),this.tok.T_AND_EQUAL):t==="&"?(this.input(),this.tok.T_BOOLEAN_AND):"&"},"|"(){let t=this._input[this.offset];return t==="="?(this.input(),this.tok.T_OR_EQUAL):t==="|"?(this.input(),this.tok.T_BOOLEAN_OR):"|"},"^"(){return this._input[this.offset]==="="?(this.input(),this.tok.T_XOR_EQUAL):"^"}}}});var Yt=h((ou,Qt)=>{"use strict";var Bl=";:,.\\[]()|^&+-/*=%!~$<>?@";Qt.exports={is_NUM(){let t=this._input.charCodeAt(this.offset-1);return t>47&&t<58||t===95},is_NUM_START(){let t=this._input.charCodeAt(this.offset-1);return t>47&&t<58},is_LABEL(){let t=this._input.charCodeAt(this.offset-1);return t>96&&t<123||t>64&&t<91||t===95||t>47&&t<58||t>126},is_LABEL_START(){let t=this._input.charCodeAt(this.offset-1);return t>64&&t<91||t>96&&t<123||t===95||t>126},consume_LABEL(){for(;this.offset<this.size;){let t=this.input();if(!this.is_LABEL()){t&&this.unput(1);break}}return this},is_TOKEN(){let t=this._input[this.offset-1];return Bl.indexOf(t)!==-1},is_WHITESPACE(){let t=this._input[this.offset-1];return t===" "||t==="	"||t===`
`||t==="\r"},is_TABSPACE(){let t=this._input[this.offset-1];return t===" "||t==="	"},consume_TABSPACE(){for(;this.offset<this.size;){let t=this.input();if(!this.is_TABSPACE()){t&&this.unput(1);break}}return this},is_HEX(){let t=this._input.charCodeAt(this.offset-1);return t>47&&t<58||t>64&&t<71||t>96&&t<103||t===95},is_OCTAL(){let t=this._input.charCodeAt(this.offset-1);return t>47&&t<56||t===95}}});var zt=h((hu,$t)=>{"use strict";var k=function(t){this.engine=t,this.tok=this.engine.tokens.names,this.EOF=1,this.debug=!1,this.all_tokens=!0,this.comment_tokens=!1,this.mode_eval=!1,this.asp_tags=!1,this.short_tags=!1,this.version=803,this.yyprevcol=0,this.keywords={__class__:this.tok.T_CLASS_C,__trait__:this.tok.T_TRAIT_C,__function__:this.tok.T_FUNC_C,__method__:this.tok.T_METHOD_C,__line__:this.tok.T_LINE,__file__:this.tok.T_FILE,__dir__:this.tok.T_DIR,__namespace__:this.tok.T_NS_C,exit:this.tok.T_EXIT,die:this.tok.T_EXIT,function:this.tok.T_FUNCTION,const:this.tok.T_CONST,return:this.tok.T_RETURN,try:this.tok.T_TRY,catch:this.tok.T_CATCH,finally:this.tok.T_FINALLY,throw:this.tok.T_THROW,if:this.tok.T_IF,elseif:this.tok.T_ELSEIF,endif:this.tok.T_ENDIF,else:this.tok.T_ELSE,while:this.tok.T_WHILE,endwhile:this.tok.T_ENDWHILE,do:this.tok.T_DO,for:this.tok.T_FOR,endfor:this.tok.T_ENDFOR,foreach:this.tok.T_FOREACH,endforeach:this.tok.T_ENDFOREACH,declare:this.tok.T_DECLARE,enddeclare:this.tok.T_ENDDECLARE,instanceof:this.tok.T_INSTANCEOF,as:this.tok.T_AS,switch:this.tok.T_SWITCH,endswitch:this.tok.T_ENDSWITCH,case:this.tok.T_CASE,default:this.tok.T_DEFAULT,break:this.tok.T_BREAK,continue:this.tok.T_CONTINUE,goto:this.tok.T_GOTO,echo:this.tok.T_ECHO,print:this.tok.T_PRINT,class:this.tok.T_CLASS,interface:this.tok.T_INTERFACE,trait:this.tok.T_TRAIT,enum:this.tok.T_ENUM,extends:this.tok.T_EXTENDS,implements:this.tok.T_IMPLEMENTS,new:this.tok.T_NEW,clone:this.tok.T_CLONE,var:this.tok.T_VAR,eval:this.tok.T_EVAL,include:this.tok.T_INCLUDE,include_once:this.tok.T_INCLUDE_ONCE,require:this.tok.T_REQUIRE,require_once:this.tok.T_REQUIRE_ONCE,namespace:this.tok.T_NAMESPACE,use:this.tok.T_USE,insteadof:this.tok.T_INSTEADOF,global:this.tok.T_GLOBAL,isset:this.tok.T_ISSET,empty:this.tok.T_EMPTY,__halt_compiler:this.tok.T_HALT_COMPILER,static:this.tok.T_STATIC,abstract:this.tok.T_ABSTRACT,final:this.tok.T_FINAL,private:this.tok.T_PRIVATE,protected:this.tok.T_PROTECTED,public:this.tok.T_PUBLIC,unset:this.tok.T_UNSET,list:this.tok.T_LIST,array:this.tok.T_ARRAY,callable:this.tok.T_CALLABLE,or:this.tok.T_LOGICAL_OR,and:this.tok.T_LOGICAL_AND,xor:this.tok.T_LOGICAL_XOR,match:this.tok.T_MATCH,readonly:this.tok.T_READ_ONLY},this.castKeywords={int:this.tok.T_INT_CAST,integer:this.tok.T_INT_CAST,real:this.tok.T_DOUBLE_CAST,double:this.tok.T_DOUBLE_CAST,float:this.tok.T_DOUBLE_CAST,string:this.tok.T_STRING_CAST,binary:this.tok.T_STRING_CAST,array:this.tok.T_ARRAY_CAST,object:this.tok.T_OBJECT_CAST,bool:this.tok.T_BOOL_CAST,boolean:this.tok.T_BOOL_CAST,unset:this.tok.T_UNSET_CAST}};k.prototype.setInput=function(t){return this._input=t,this.size=t.length,this.yylineno=1,this.offset=0,this.yyprevcol=0,this.yytext="",this.yylloc={first_offset:0,first_line:1,first_column:0,prev_offset:0,prev_line:1,prev_column:0,last_line:1,last_column:0},this.tokens=[],this.version>703?this.keywords.fn=this.tok.T_FN:delete this.keywords.fn,this.done=this.offset>=this.size,!this.all_tokens&&this.mode_eval?(this.conditionStack=["INITIAL"],this.begin("ST_IN_SCRIPTING")):(this.conditionStack=[],this.begin("INITIAL")),this.heredoc_label={label:"",length:0,indentation:0,indentation_uses_spaces:!1,finished:!1,first_encaps_node:!1,toString(){this.label}},this};k.prototype.input=function(){let t=this._input[this.offset];return t?(this.yytext+=t,this.offset++,t==="\r"&&this._input[this.offset]===`
`&&(this.yytext+=`
`,this.offset++),t===`
`||t==="\r"?(this.yylloc.last_line=++this.yylineno,this.yyprevcol=this.yylloc.last_column,this.yylloc.last_column=0):this.yylloc.last_column++,t):""};k.prototype.unput=function(t){if(t===1)this.offset--,this._input[this.offset]===`
`&&this._input[this.offset-1]==="\r"&&(this.offset--,t++),this._input[this.offset]==="\r"||this._input[this.offset]===`
`?(this.yylloc.last_line--,this.yylineno--,this.yylloc.last_column=this.yyprevcol):this.yylloc.last_column--,this.yytext=this.yytext.substring(0,this.yytext.length-t);else if(t>0)if(this.offset-=t,t<this.yytext.length){this.yytext=this.yytext.substring(0,this.yytext.length-t),this.yylloc.last_line=this.yylloc.first_line,this.yylloc.last_column=this.yyprevcol=this.yylloc.first_column;for(let e=0;e<this.yytext.length;e++){let s=this.yytext[e];s==="\r"?(s=this.yytext[++e],this.yyprevcol=this.yylloc.last_column,this.yylloc.last_line++,this.yylloc.last_column=0,s!==`
`&&(s==="\r"?this.yylloc.last_line++:this.yylloc.last_column++)):s===`
`?(this.yyprevcol=this.yylloc.last_column,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++}this.yylineno=this.yylloc.last_line}else this.yytext="",this.yylloc.last_line=this.yylineno=this.yylloc.first_line,this.yylloc.last_column=this.yylloc.first_column;return this};k.prototype.tryMatch=function(t){return t===this.ahead(t.length)};k.prototype.tryMatchCaseless=function(t){return t===this.ahead(t.length).toLowerCase()};k.prototype.ahead=function(t){let e=this._input.substring(this.offset,this.offset+t);return e[e.length-1]==="\r"&&this._input[this.offset+t+1]===`
`&&(e+=`
`),e};k.prototype.consume=function(t){for(let e=0;e<t;e++){let s=this._input[this.offset];if(!s)break;this.yytext+=s,this.offset++,s==="\r"&&this._input[this.offset]===`
`&&(this.yytext+=`
`,this.offset++,e++),s===`
`||s==="\r"?(this.yylloc.last_line=++this.yylineno,this.yyprevcol=this.yylloc.last_column,this.yylloc.last_column=0):this.yylloc.last_column++}return this};k.prototype.getState=function(){return{yytext:this.yytext,offset:this.offset,yylineno:this.yylineno,yyprevcol:this.yyprevcol,yylloc:{first_offset:this.yylloc.first_offset,first_line:this.yylloc.first_line,first_column:this.yylloc.first_column,last_line:this.yylloc.last_line,last_column:this.yylloc.last_column},heredoc_label:this.heredoc_label}};k.prototype.setState=function(t){return this.yytext=t.yytext,this.offset=t.offset,this.yylineno=t.yylineno,this.yyprevcol=t.yyprevcol,this.yylloc=t.yylloc,t.heredoc_label&&(this.heredoc_label=t.heredoc_label),this};k.prototype.appendToken=function(t,e){return this.tokens.push([t,e]),this};k.prototype.lex=function(){this.yylloc.prev_offset=this.offset,this.yylloc.prev_line=this.yylloc.last_line,this.yylloc.prev_column=this.yylloc.last_column;let t=this.next()||this.lex();if(!this.all_tokens){for(;t===this.tok.T_WHITESPACE||!this.comment_tokens&&(t===this.tok.T_COMMENT||t===this.tok.T_DOC_COMMENT)||t===this.tok.T_OPEN_TAG;)t=this.next()||this.lex();if(t==this.tok.T_OPEN_TAG_WITH_ECHO)return this.tok.T_ECHO;if(t===this.tok.T_CLOSE_TAG)return";"}return this.yylloc.prev_offset||(this.yylloc.prev_offset=this.yylloc.first_offset,this.yylloc.prev_line=this.yylloc.first_line,this.yylloc.prev_column=this.yylloc.first_column),t};k.prototype.begin=function(t){if(this.conditionStack.push(t),this.curCondition=t,this.stateCb=this["match"+t],typeof this.stateCb!="function")throw new Error('Undefined condition state "'+t+'"');return this};k.prototype.popState=function(){let e=this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0];if(this.curCondition=this.conditionStack[this.conditionStack.length-1],this.stateCb=this["match"+this.curCondition],typeof this.stateCb!="function")throw new Error('Undefined condition state "'+this.curCondition+'"');return e};k.prototype.next=function(){let t;if(this._input||(this.done=!0),this.yylloc.first_offset=this.offset,this.yylloc.first_line=this.yylloc.last_line,this.yylloc.first_column=this.yylloc.last_column,this.yytext="",this.done)return this.yylloc.prev_offset=this.yylloc.first_offset,this.yylloc.prev_line=this.yylloc.first_line,this.yylloc.prev_column=this.yylloc.first_column,this.EOF;if(this.tokens.length>0?(t=this.tokens.shift(),typeof t[1]=="object"?this.setState(t[1]):this.consume(t[1]),t=t[0]):t=this.stateCb.apply(this,[]),this.offset>=this.size&&this.tokens.length===0&&(this.done=!0),this.debug){let e=t;typeof e=="number"?e=this.engine.tokens.values[e]:e='"'+e+'"';let s=new Error(e+"	from "+this.yylloc.first_line+","+this.yylloc.first_column+"	 - to "+this.yylloc.last_line+","+this.yylloc.last_column+'	"'+this.yytext+'"');console.error(s.stack)}return t};[Ot(),gt(),vt(),Pt(),Mt(),Bt(),Kt(),Wt(),Yt()].forEach(function(t){for(let e in t)k.prototype[e]=t[e]});$t.exports=k});var it=h((au,jt)=>{"use strict";var Gl=function(t,e,s){this.line=t,this.column=e,this.offset=s};jt.exports=Gl});var Jt=h((cu,Xt)=>{"use strict";Xt.exports={read_array(){let t=null,e=!1,s=this.node("array");this.token===this.tok.T_ARRAY?(this.next().expect("("),t=")"):(e=!0,t="]");let i=[];return this.next().token!==t&&(i=this.read_array_pair_list(e)),this.expect(t),this.next(),s(e,i)},read_array_pair_list(t){let e=this;return this.read_list(function(){return e.read_array_pair(t)},",",!0)},read_array_pair(t){if(!t&&this.token===")"||t&&this.token==="]")return;if(this.token===",")return this.node("noop")();let e=this.node("entry"),s=null,i=null,n=!1,r=!1;if(this.token==="&")this.next(),n=!0,i=this.read_variable(!0,!1);else if(this.token===this.tok.T_ELLIPSIS&&this.version>=704)this.next(),this.token==="&"&&this.error(),r=!0,i=this.read_expr();else{let o=this.read_expr();this.token===this.tok.T_DOUBLE_ARROW?(this.next(),s=o,this.token==="&"?(this.next(),n=!0,i=this.read_variable(!0,!1)):i=this.read_expr()):i=o}return e(s,i,n,r)}}});var te=h((lu,Zt)=>{"use strict";Zt.exports={read_class_declaration_statement(t){let e=this.node("class"),s=this.read_class_modifiers();if(this.token!==this.tok.T_CLASS)return this.error(this.tok.T_CLASS),this.next(),null;this.next().expect(this.tok.T_STRING);let i=this.node("identifier"),n=this.text();this.next(),i=i(n);let r=this.read_extends_from(),o=this.read_implements_list();this.expect("{");let a=this.next().read_class_body(!0,!1),c=e(i,r,o,a,s);return t&&(c.attrGroups=t),c},read_class_modifiers(){let t=this.read_class_modifier({readonly:0,final_or_abstract:0});return[0,0,t.final_or_abstract,t.readonly]},read_class_modifier(t){return this.token===this.tok.T_READ_ONLY?(this.next(),t.readonly=1,t=this.read_class_modifier(t)):t.final_or_abstract===0&&this.token===this.tok.T_ABSTRACT?(this.next(),t.final_or_abstract=1,t=this.read_class_modifier(t)):t.final_or_abstract===0&&this.token===this.tok.T_FINAL&&(this.next(),t.final_or_abstract=2,t=this.read_class_modifier(t)),t},read_class_body(t,e){let s=[],i=[];for(;this.token!==this.EOF&&this.token!=="}";){if(this.token===this.tok.T_COMMENT){s.push(this.read_comment());continue}if(this.token===this.tok.T_DOC_COMMENT){s.push(this.read_doc_comment());continue}if(this.token===this.tok.T_USE){s=s.concat(this.read_trait_use_statement());continue}if(e&&this.token===this.tok.T_CASE){let o=this.read_enum_case();this.expect(";")&&this.next(),s=s.concat(o);continue}this.token===this.tok.T_ATTRIBUTE&&(i=this.read_attr_list());let n=this.position(),r=this.read_member_flags(!1);if(this.token===this.tok.T_CONST){let o=this.read_constant_list(r,i);this.expect(";")&&this.next(),s=s.concat(o);continue}if(t&&this.token===this.tok.T_VAR&&(this.next().expect(this.tok.T_VARIABLE),r[0]=null,r[1]=0),this.token===this.tok.T_FUNCTION)s.push(this.read_function(!1,r,i,n)),i=[];else if(t&&(this.token===this.tok.T_VARIABLE||this.version>=801&&this.token===this.tok.T_READ_ONLY||this.version>=704&&(this.token==="?"||this.token===this.tok.T_ARRAY||this.token===this.tok.T_CALLABLE||this.token===this.tok.T_NAMESPACE||this.token===this.tok.T_NAME_FULLY_QUALIFIED||this.token===this.tok.T_NAME_QUALIFIED||this.token===this.tok.T_NAME_RELATIVE||this.token===this.tok.T_NS_SEPARATOR||this.token===this.tok.T_STRING))){let o=this.read_variable_list(r,i);i=[],this.expect(";"),this.next(),s=s.concat(o)}else this.error([this.tok.T_CONST,...t?[this.tok.T_VARIABLE]:[],...e?[this.tok.T_CASE]:[],this.tok.T_FUNCTION]),this.next()}return this.expect("}"),this.next(),s},read_variable_list(t,e){let s=this.node("propertystatement"),i=this.read_list(function(){let r=this.node("property"),o=!1;this.token===this.tok.T_READ_ONLY&&(o=!0,this.next());let[a,c]=this.read_optional_type();this.expect(this.tok.T_VARIABLE);let l=this.node("identifier"),f=this.text().substring(1);this.next(),l=l(f);let T=null;return this.expect([",",";","="]),this.token==="="&&(T=this.next().read_expr()),r(l,T,o,a,c,e||[])},",");return s(null,i,t)},read_constant_list(t,e){this.expect(this.tok.T_CONST)&&this.next();let[s,i]=this.version>=803?this.read_optional_type():[!1,null],n=this.node("classconstant"),r=this.read_list(function(){let a=this.node("constant"),c=null,l=null;if(this.token===this.tok.T_STRING||this.version>=700&&this.is("IDENTIFIER")){c=this.node("identifier");let f=this.text();this.next(),c=c(f)}else this.expect("IDENTIFIER");return this.expect("=")&&(l=this.next().read_expr()),a(c,l)},",");return n(null,r,t,s,i,e||[])},read_member_flags(t){let e=[-1,-1,-1];if(this.is("T_MEMBER_FLAGS")){let s=0,i=0;do{switch(this.token){case this.tok.T_PUBLIC:s=0,i=0;break;case this.tok.T_PROTECTED:s=0,i=1;break;case this.tok.T_PRIVATE:s=0,i=2;break;case this.tok.T_STATIC:s=1,i=1;break;case this.tok.T_ABSTRACT:s=2,i=1;break;case this.tok.T_FINAL:s=2,i=2;break}t&&(s===0&&i===2?(this.expect([this.tok.T_PUBLIC,this.tok.T_PROTECTED]),i=-1):s===2&&i===1&&(this.error(),i=-1)),e[s]!==-1?this.error():i!==-1&&(e[s]=i)}while(this.next().is("T_MEMBER_FLAGS"))}return e[1]===-1&&(e[1]=0),e[2]===-1&&(e[2]=0),e},read_optional_type(){let t=this.token==="?";if(t&&this.next(),this.peekSkipComments()==="=")return[!1,null];let e=this.read_types();if(t&&!e&&this.raiseError("Expecting a type definition combined with nullable operator"),!t&&!e)return[!1,null];if(this.token==="|"){e=[e];do{this.next();let s=this.read_type();if(!s){this.raiseError("Expecting a type definition");break}e.push(s)}while(this.token==="|")}return[t,e]},peekSkipComments(){let t=this.lexer.getState(),e;do e=this.lexer.lex();while(e===this.tok.T_COMMENT||e===this.tok.T_WHITESPACE);return this.lexer.setState(t),e},read_interface_declaration_statement(t){let e=this.node("interface");if(this.token!==this.tok.T_INTERFACE)return this.error(this.tok.T_INTERFACE),this.next(),null;this.next().expect(this.tok.T_STRING);let s=this.node("identifier"),i=this.text();this.next(),s=s(i);let n=this.read_interface_extends_list();this.expect("{");let r=this.next().read_interface_body();return e(s,n,r,t||[])},read_interface_body(){let t=[],e=[];for(;this.token!==this.EOF&&this.token!=="}";){if(this.token===this.tok.T_COMMENT){t.push(this.read_comment());continue}if(this.token===this.tok.T_DOC_COMMENT){t.push(this.read_doc_comment());continue}let s=this.position();e=this.read_attr_list();let i=this.read_member_flags(!0);if(this.token===this.tok.T_CONST){let n=this.read_constant_list(i,e);this.expect(";")&&this.next(),t=t.concat(n),e=[]}else if(this.token===this.tok.T_FUNCTION){let n=this.read_function_declaration(2,i,e,s);n.parseFlags(i),t.push(n),this.expect(";")&&this.next(),e=[]}else this.error([this.tok.T_CONST,this.tok.T_FUNCTION]),this.next()}return this.expect("}")&&this.next(),t},read_trait_declaration_statement(){let t=this.node("trait");if(this.token!==this.tok.T_TRAIT)return this.error(this.tok.T_TRAIT),this.next(),null;this.next().expect(this.tok.T_STRING);let e=this.node("identifier"),s=this.text();this.next(),e=e(s),this.expect("{");let i=this.next().read_class_body(!0,!1);return t(e,i)},read_trait_use_statement(){let t=this.node("traituse");this.expect(this.tok.T_USE)&&this.next();let e=[this.read_namespace_name()],s=null;for(;this.token===",";)e.push(this.next().read_namespace_name());if(this.token==="{"){for(s=[];this.next().token!==this.EOF&&this.token!=="}";)s.push(this.read_trait_use_alias()),this.expect(";");this.expect("}")&&this.next()}else this.expect(";")&&this.next();return t(e,s)},read_trait_use_alias(){let t=this.node(),e=null,s;if(this.is("IDENTIFIER")){s=this.node("identifier");let i=this.text();this.next(),s=s(i)}else if(s=this.read_namespace_name(),this.token===this.tok.T_DOUBLE_COLON)if(this.next(),this.token===this.tok.T_STRING||this.version>=700&&this.is("IDENTIFIER")){e=s,s=this.node("identifier");let i=this.text();this.next(),s=s(i)}else this.expect(this.tok.T_STRING);else s=s.name;if(this.token===this.tok.T_INSTEADOF)return t("traitprecedence",e,s,this.next().read_name_list());if(this.token===this.tok.T_AS){let i=null,n=null;if(this.next().is("T_MEMBER_FLAGS")&&(i=this.read_member_flags()),this.token===this.tok.T_STRING||this.version>=700&&this.is("IDENTIFIER")){n=this.node("identifier");let r=this.text();this.next(),n=n(r)}else i===!1&&this.expect(this.tok.T_STRING);return t("traitalias",e,s,n,i)}return this.expect([this.tok.T_AS,this.tok.T_INSTEADOF]),t("traitalias",e,s,null,null)}}});var se=h((_u,ee)=>{"use strict";ee.exports={read_comment(){let t=this.text(),e=this.ast.prepare(t.substring(0,2)==="/*"?"commentblock":"commentline",null,this),s=this.lexer.yylloc.first_offset,i=this.prev;return this.prev=[this.lexer.yylloc.last_line,this.lexer.yylloc.last_column,this.lexer.offset],this.lex(),e=e(t),e.offset=s,this.prev=i,e},read_doc_comment(){let t=this.ast.prepare("commentblock",null,this),e=this.lexer.yylloc.first_offset,s=this.text(),i=this.prev;return this.prev=[this.lexer.yylloc.last_line,this.lexer.yylloc.last_column,this.lexer.offset],this.lex(),t=t(s),t.offset=e,this.prev=i,t}}});var ne=h((uu,ie)=>{"use strict";ie.exports={read_expr(t){let e=this.node();if(this.token==="@")return t||(t=this.next().read_expr()),e("silent",t);if(t||(t=this.read_expr_item()),this.token==="|")return e("bin","|",t,this.next().read_expr());if(this.token==="&")return e("bin","&",t,this.next().read_expr());if(this.token==="^")return e("bin","^",t,this.next().read_expr());if(this.token===".")return e("bin",".",t,this.next().read_expr());if(this.token==="+")return e("bin","+",t,this.next().read_expr());if(this.token==="-")return e("bin","-",t,this.next().read_expr());if(this.token==="*")return e("bin","*",t,this.next().read_expr());if(this.token==="/")return e("bin","/",t,this.next().read_expr());if(this.token==="%")return e("bin","%",t,this.next().read_expr());if(this.token===this.tok.T_POW)return e("bin","**",t,this.next().read_expr());if(this.token===this.tok.T_SL)return e("bin","<<",t,this.next().read_expr());if(this.token===this.tok.T_SR)return e("bin",">>",t,this.next().read_expr());if(this.token===this.tok.T_BOOLEAN_OR)return e("bin","||",t,this.next().read_expr());if(this.token===this.tok.T_LOGICAL_OR)return e("bin","or",t,this.next().read_expr());if(this.token===this.tok.T_BOOLEAN_AND)return e("bin","&&",t,this.next().read_expr());if(this.token===this.tok.T_LOGICAL_AND)return e("bin","and",t,this.next().read_expr());if(this.token===this.tok.T_LOGICAL_XOR)return e("bin","xor",t,this.next().read_expr());if(this.token===this.tok.T_IS_IDENTICAL)return e("bin","===",t,this.next().read_expr());if(this.token===this.tok.T_IS_NOT_IDENTICAL)return e("bin","!==",t,this.next().read_expr());if(this.token===this.tok.T_IS_EQUAL)return e("bin","==",t,this.next().read_expr());if(this.token===this.tok.T_IS_NOT_EQUAL)return e("bin","!=",t,this.next().read_expr());if(this.token==="<")return e("bin","<",t,this.next().read_expr());if(this.token===">")return e("bin",">",t,this.next().read_expr());if(this.token===this.tok.T_IS_SMALLER_OR_EQUAL)return e("bin","<=",t,this.next().read_expr());if(this.token===this.tok.T_IS_GREATER_OR_EQUAL)return e("bin",">=",t,this.next().read_expr());if(this.token===this.tok.T_SPACESHIP)return e("bin","<=>",t,this.next().read_expr());if(this.token===this.tok.T_INSTANCEOF&&(t=e("bin","instanceof",t,this.next().read_class_name_reference()),this.token!==";"&&this.token!==this.tok.T_INLINE_HTML&&this.token!==this.EOF&&(t=this.read_expr(t))),this.token===this.tok.T_COALESCE)return e("bin","??",t,this.next().read_expr());if(this.token==="?"){let s=null;return this.next().token!==":"&&(s=this.read_expr()),this.expect(":")&&this.next(),e("retif",t,s,this.read_expr())}else e.destroy(t);return t},read_expr_cast(t){return this.node("cast")(t,this.text(),this.next().read_expr())},read_isset_variable(){return this.read_expr()},read_isset_variables(){return this.read_function_list(this.read_isset_variable,",")},read_internal_functions_in_yacc(){let t=null;switch(this.token){case this.tok.T_ISSET:{t=this.node("isset"),this.next().expect("(")&&this.next();let e=this.read_isset_variables();this.expect(")")&&this.next(),t=t(e)}break;case this.tok.T_EMPTY:{t=this.node("empty"),this.next().expect("(")&&this.next();let e=this.read_expr();this.expect(")")&&this.next(),t=t(e)}break;case this.tok.T_INCLUDE:t=this.node("include")(!1,!1,this.next().read_expr());break;case this.tok.T_INCLUDE_ONCE:t=this.node("include")(!0,!1,this.next().read_expr());break;case this.tok.T_EVAL:{t=this.node("eval"),this.next().expect("(")&&this.next();let e=this.read_expr();this.expect(")")&&this.next(),t=t(e)}break;case this.tok.T_REQUIRE:t=this.node("include")(!1,!0,this.next().read_expr());break;case this.tok.T_REQUIRE_ONCE:t=this.node("include")(!0,!0,this.next().read_expr());break}return t},read_optional_expr(t){return this.token!==t?this.read_expr():null},read_exit_expr(){let t=null;return this.token==="("&&(this.next(),t=this.read_optional_expr(")"),this.expect(")")&&this.next()),t},read_expr_item(){let t,e,s=[];if(this.token==="+")return this.node("unary")("+",this.next().read_expr());if(this.token==="-")return this.node("unary")("-",this.next().read_expr());if(this.token==="!")return this.node("unary")("!",this.next().read_expr());if(this.token==="~")return this.node("unary")("~",this.next().read_expr());if(this.token==="(")return e=this.next().read_expr(),e.parenthesizedExpression=!0,this.expect(")")&&this.next(),this.handleDereferencable(e);if(this.token==="`")return this.read_encapsed_string("`");if(this.token===this.tok.T_LIST){let i=null,n=this.innerList;t=this.node("list"),n||(i=this.node("assign")),this.next().expect("(")&&this.next(),this.innerList||(this.innerList=!0);let r=this.read_array_pair_list(!1);this.expect(")")&&this.next();let o=!1;for(let a=0;a<r.length;a++)if(r[a]!==null&&r[a].kind!=="noop"){o=!0;break}return o||this.raiseError("Fatal Error :  Cannot use empty list on line "+this.lexer.yylloc.first_line),n?t(r,!1):(this.innerList=!1,this.expect("=")?i(t(r,!1),this.next().read_expr(),"="):t(r,!1))}if(this.token===this.tok.T_ATTRIBUTE&&(s=this.read_attr_list()),this.token===this.tok.T_CLONE)return this.node("clone")(this.next().read_expr());switch(this.token){case this.tok.T_INC:return this.node("pre")("+",this.next().read_variable(!1,!1));case this.tok.T_DEC:return this.node("pre")("-",this.next().read_variable(!1,!1));case this.tok.T_NEW:return e=this.read_new_expr(),this.token===this.tok.T_OBJECT_OPERATOR&&this.version<804&&this.raiseError("New without parenthesis is not allowed before PHP 8.4"),this.handleDereferencable(e);case this.tok.T_ISSET:case this.tok.T_EMPTY:case this.tok.T_INCLUDE:case this.tok.T_INCLUDE_ONCE:case this.tok.T_EVAL:case this.tok.T_REQUIRE:case this.tok.T_REQUIRE_ONCE:return this.read_internal_functions_in_yacc();case this.tok.T_MATCH:return this.read_match_expression();case this.tok.T_INT_CAST:return this.read_expr_cast("int");case this.tok.T_DOUBLE_CAST:return this.read_expr_cast("float");case this.tok.T_STRING_CAST:return this.read_expr_cast(this.text().indexOf("binary")!==-1?"binary":"string");case this.tok.T_ARRAY_CAST:return this.read_expr_cast("array");case this.tok.T_OBJECT_CAST:return this.read_expr_cast("object");case this.tok.T_BOOL_CAST:return this.read_expr_cast("bool");case this.tok.T_UNSET_CAST:return this.read_expr_cast("unset");case this.tok.T_THROW:{this.version<800&&this.raiseError("PHP 8+ is required to use throw as an expression");let i=this.node("throw"),n=this.next().read_expr();return i(n)}case this.tok.T_EXIT:{let i=this.lexer.yytext.toLowerCase()==="die";t=this.node("exit"),this.next();let n=this.read_exit_expr();return t(n,i)}case this.tok.T_PRINT:return this.node("print")(this.next().read_expr());case this.tok.T_YIELD:{let i=null,n=null;return t=this.node("yield"),this.next().is("EXPR")&&(i=this.read_expr(),this.token===this.tok.T_DOUBLE_ARROW&&(n=i,i=this.next().read_expr())),t(i,n)}case this.tok.T_YIELD_FROM:return t=this.node("yieldfrom"),e=this.next().read_expr(),t(e);case this.tok.T_FN:case this.tok.T_FUNCTION:return this.read_inline_function(void 0,s);case this.tok.T_STATIC:{let i=[this.token,this.lexer.getState()];if(this.next(),this.token===this.tok.T_FUNCTION||this.version>=704&&this.token===this.tok.T_FN)return this.read_inline_function([0,1,0],s);this.lexer.tokens.push(i),this.next()}}if(this.is("VARIABLE")){t=this.node(),e=this.read_variable(!1,!1);let i=e.kind==="identifier"||e.kind==="staticlookup"&&e.offset.kind==="identifier";switch(this.token){case"=":return i&&this.error("VARIABLE"),this.next().token=="&"?this.read_assignref(t,e):t("assign",e,this.read_expr(),"=");case this.tok.T_PLUS_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"+=");case this.tok.T_MINUS_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"-=");case this.tok.T_MUL_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"*=");case this.tok.T_POW_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"**=");case this.tok.T_DIV_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"/=");case this.tok.T_CONCAT_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),".=");case this.tok.T_MOD_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"%=");case this.tok.T_AND_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"&=");case this.tok.T_OR_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"|=");case this.tok.T_XOR_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"^=");case this.tok.T_SL_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"<<=");case this.tok.T_SR_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),">>=");case this.tok.T_COALESCE_EQUAL:return i&&this.error("VARIABLE"),t("assign",e,this.next().read_expr(),"??=");case this.tok.T_INC:return i&&this.error("VARIABLE"),this.next(),t("post","+",e);case this.tok.T_DEC:return i&&this.error("VARIABLE"),this.next(),t("post","-",e);default:t.destroy(e)}}else if(this.is("SCALAR")){if(t=this.node(),e=this.read_scalar(),e.kind==="array"&&e.shortForm&&this.token==="="){let i=this.convertToList(e);e.loc&&(i.loc=e.loc);let n=this.next().read_expr();return t("assign",i,n,"=")}else t.destroy(e);return this.handleDereferencable(e)}else this.error("EXPR"),this.next();return e},convertToList(t){let e=t.items.map(i=>(i.value&&i.value.kind==="array"&&i.value.shortForm&&(i.value=this.convertToList(i.value)),i)),s=this.node("list")(e,!0);return t.loc&&(s.loc=t.loc),t.leadingComments&&(s.leadingComments=t.leadingComments),t.trailingComments&&(s.trailingComments=t.trailingComments),s},read_assignref(t,e){this.next();let s;return this.token===this.tok.T_NEW?(this.version>=700&&this.error(),s=this.read_new_expr()):s=this.read_variable(!1,!1),t("assignref",e,s)},read_inline_function(t,e){if(this.token===this.tok.T_FUNCTION){let l=this.read_function(!0,t,e);return l.attrGroups=e,l}!this.version>=704&&this.raiseError("Arrow Functions are not allowed");let s=this.node("arrowfunc");this.expect(this.tok.T_FN)&&this.next();let i=this.is_reference();this.expect("(")&&this.next();let n=this.read_parameter_list();this.expect(")")&&this.next();let r=!1,o=null;this.token===":"&&(this.next().token==="?"&&(r=!0,this.next()),o=this.read_types()),this.expect(this.tok.T_DOUBLE_ARROW)&&this.next();let a=this.read_expr(),c=s(n,i,a,o,r,!!t);return c.attrGroups=e,c},read_match_expression(){let t=this.node("match");this.expect(this.tok.T_MATCH)&&this.next(),this.version<800&&this.raiseError("Match statements are not allowed before PHP 8");let e=null,s=[];return this.expect("(")&&this.next(),e=this.read_expr(),this.expect(")")&&this.next(),this.expect("{")&&this.next(),s=this.read_match_arms(),this.expect("}")&&this.next(),t(e,s)},read_match_arms(){return this.read_list(()=>this.read_match_arm(),",",!0)},read_match_arm(){if(this.token!=="}")return this.node("matcharm")(this.read_match_arm_conds(),this.read_expr())},read_match_arm_conds(){let t=[];if(this.token===this.tok.T_DEFAULT)t=null,this.next();else for(t.push(this.read_expr());this.token===",";){if(this.next(),this.token===this.tok.T_DOUBLE_ARROW)return this.next(),t;t.push(this.read_expr())}return this.expect(this.tok.T_DOUBLE_ARROW)&&this.next(),t},read_attribute(){let t=this.text(),e=[];return this.next(),this.token==="("&&(e=this.read_argument_list()),this.node("attribute")(t,e)},read_attr_list(){let t=[];if(this.token===this.tok.T_ATTRIBUTE)do{let e=this.node("attrgroup")([]);for(this.next(),e.attrs.push(this.read_attribute());this.token===",";)this.next(),this.token!=="]"&&e.attrs.push(this.read_attribute());t.push(e),this.expect("]"),this.next()}while(this.token===this.tok.T_ATTRIBUTE);return t},read_new_expr(){let t=this.node("new");this.expect(this.tok.T_NEW)&&this.next();let e=[];if(this.token==="("){this.next();let n=this.read_expr();return this.expect(")"),this.next(),this.token==="("&&(e=this.read_argument_list()),t(n,e)}let s=this.read_attr_list();if(this.token===this.tok.T_CLASS){let n=this.node("class");this.next().token==="("&&(e=this.read_argument_list());let r=this.read_extends_from(),o=this.read_implements_list(),a=null;this.expect("{")&&(a=this.next().read_class_body(!0,!1));let c=n(null,r,o,a,[0,0,0]);return c.attrGroups=s,t(c,e)}let i=this.read_new_class_name();for(;this.token==="[";){let n=this.node("offsetlookup"),r=this.next().read_encaps_var_offset();this.expect("]")&&this.next(),i=n(i,r)}return this.token==="("&&(e=this.read_argument_list()),t(i,e)},read_new_class_name(){if(this.token===this.tok.T_NS_SEPARATOR||this.token===this.tok.T_NAME_RELATIVE||this.token===this.tok.T_NAME_QUALIFIED||this.token===this.tok.T_NAME_FULLY_QUALIFIED||this.token===this.tok.T_STRING||this.token===this.tok.T_NAMESPACE){let t=this.read_namespace_name(!0);return this.token===this.tok.T_DOUBLE_COLON&&(t=this.read_static_getter(t)),t}else{if(this.is("VARIABLE"))return this.read_variable(!0,!1);this.expect([this.tok.T_STRING,"VARIABLE"])}},handleDereferencable(t){for(;this.token!==this.EOF;)if(this.token===this.tok.T_OBJECT_OPERATOR||this.token===this.tok.T_DOUBLE_COLON)t=this.recursive_variable_chain_scan(t,!1,!1,!0);else if(this.token===this.tok.T_CURLY_OPEN||this.token==="[")t=this.read_dereferencable(t);else if(this.token==="(")t=this.node("call")(t,this.read_argument_list());else return t;return t}}});var oe=h((fu,re)=>{"use strict";re.exports={read_enum_declaration_statement(t){let e=this.node("enum");if(!this.expect(this.tok.T_ENUM))return null;this.next().expect(this.tok.T_STRING);let s=this.node("identifier"),i=this.text();this.next(),s=s(i);let n=this.read_enum_value_type(),r=this.read_implements_list();this.expect("{");let o=this.next().read_class_body(!1,!0),a=e(s,n,r,o);return t&&(a.attrGroups=t),a},read_enum_value_type(){return this.token===":"?this.next().read_namespace_name():null},read_enum_case(){this.expect(this.tok.T_CASE);let t=this.node("enumcase"),e=this.node("identifier"),s=this.next().text();this.next(),e=e(s);let i=this.token==="="?this.next().read_expr():null;return this.expect(";"),t(e,i)}}});var ae=h((pu,he)=>{"use strict";he.exports={is_reference(){return this.token==="&"?(this.next(),!0):!1},is_variadic(){return this.token===this.tok.T_ELLIPSIS?(this.next(),!0):!1},read_function(t,e,s,i){let n=this.read_function_declaration(t?1:e?2:0,e&&e[1]===1,s||[],i);return e&&e[2]==1?(n.parseFlags(e),this.expect(";")&&this.next()):(this.expect("{")&&(n.body=this.read_code_block(!1),n.loc&&n.body.loc&&(n.loc.end=n.body.loc.end)),!t&&e&&n.parseFlags(e)),n},read_function_declaration(t,e,s,i){let n="function";t===1?n="closure":t===2&&(n="method");let r=this.node(n);this.expect(this.tok.T_FUNCTION)&&this.next();let o=this.is_reference(),a=!1,c=[],l=null,f=!1;if(t!==1){let A=this.node("identifier");t===2?this.version>=700?this.token===this.tok.T_STRING||this.is("IDENTIFIER")?(a=this.text(),this.next()):this.version<704&&this.error("IDENTIFIER"):this.token===this.tok.T_STRING?(a=this.text(),this.next()):this.error("IDENTIFIER"):this.version>=700?this.token===this.tok.T_STRING?(a=this.text(),this.next()):this.version>=704?this.expect("(")||this.next():(this.error(this.tok.T_STRING),this.next()):(this.expect(this.tok.T_STRING)&&(a=this.text()),this.next()),a=A(a)}this.expect("(")&&this.next();let T=this.read_parameter_list(a.name==="__construct");this.expect(")")&&this.next(),t===1&&(c=this.read_lexical_vars()),this.token===":"&&(this.next().token==="?"&&(f=!0,this.next()),l=this.read_types());let N=A=>(A.attrGroups=s||[],i&&A.loc&&(A.loc.start=i,A.loc.source&&(A.loc.source=this.lexer._input.substr(A.loc.start.offset,A.loc.end.offset-A.loc.start.offset))),A);return N(t===1?r(T,o,c,l,f,e):r(a,T,o,l,f))},read_lexical_vars(){let t=[];return this.token===this.tok.T_USE&&(this.next(),this.expect("(")&&this.next(),t=this.read_lexical_var_list(),this.expect(")")&&this.next()),t},read_list_with_dangling_comma(t){let e=[];for(;this.token!=this.EOF;)if(e.push(t()),this.token==","){if(this.next(),this.version>=800&&this.token===")")return e}else{if(this.token==")")break;this.error([",",")"]);break}return e},read_lexical_var_list(){return this.read_list_with_dangling_comma(this.read_lexical_var.bind(this))},read_lexical_var(){if(this.token==="&")return this.read_byref(this.read_lexical_var.bind(this));let t=this.node("variable");this.expect(this.tok.T_VARIABLE);let e=this.text().substring(1);return this.next(),t(e,!1)},read_parameter_list(t){if(this.token!==")"){let e=!1;return this.read_list_with_dangling_comma(function(){let s=this.read_parameter(t);return s&&(e&&this.raiseError("Unexpected parameter after a variadic parameter"),s.variadic&&(e=!0)),s}.bind(this),",")}return[]},read_parameter(t){let e=this.node("parameter"),s=null,i=null,n=null,r=!1,o=!1,a=[];this.token===this.tok.T_ATTRIBUTE&&(a=this.read_attr_list()),this.version>=801&&this.token===this.tok.T_READ_ONLY&&(t?(this.next(),o=!0):this.raiseError("readonly properties can be used only on class constructor"));let c=this.read_promoted();!o&&this.version>=801&&this.token===this.tok.T_READ_ONLY&&(t?(this.next(),o=!0):this.raiseError("readonly properties can be used only on class constructor")),this.token==="?"&&(this.next(),r=!0),n=this.read_types(),r&&!n&&this.raiseError("Expecting a type definition combined with nullable operator");let l=this.is_reference(),f=this.is_variadic();if(this.expect(this.tok.T_VARIABLE)){s=this.node("identifier");let N=this.text().substring(1);this.next(),s=s(N)}this.token=="="&&(i=this.next().read_expr());let T=e(s,n,i,l,f,o,r,c);return a&&(T.attrGroups=a),T},read_types(){let t="unset",e="union",s="intersection",i=[],n=t,r=this.read_type();if(!r)return null;for(i.push(r);this.token==="|"||this.version>=801&&this.token==="&";){let o=this.peek();if(o===this.tok.T_ELLIPSIS||o===this.tok.T_VARIABLE)break;n===t?n=this.token==="|"?e:s:(n===e&&this.token!=="|"||n===s&&this.token!=="&")&&this.raiseError('Unexpect token "'+this.token+'", "|" and "&" can not be mixed'),this.next(),i.push(this.read_type())}return i.length===1?i[0]:n===s?this.node("intersectiontype")(i):this.node("uniontype")(i)},read_promoted(){return this.token===this.tok.T_PUBLIC?(this.next(),1):this.token===this.tok.T_PROTECTED?(this.next(),2):this.token===this.tok.T_PRIVATE?(this.next(),4):0},read_argument_list(){let t=[];return this.expect("(")&&this.next(),this.version>=801&&this.token===this.tok.T_ELLIPSIS&&this.peek()===")"?(t.push(this.node("variadicplaceholder")()),this.next()):this.token!==")"&&(t=this.read_non_empty_argument_list()),this.expect(")")&&this.next(),t},read_non_empty_argument_list(){let t=!1;return this.read_function_list(function(){let e=this.read_argument();if(e){let s=e.kind==="variadic";t&&!s&&this.raiseError("Unexpected non-variadic argument after a variadic argument"),s&&(t=!0)}return e}.bind(this),",")},read_argument(){return this.token===this.tok.T_ELLIPSIS?this.node("variadic")(this.next().read_expr()):(this.token===this.tok.T_STRING||Object.values(this.lexer.keywords).includes(this.token))&&this.peek()===":"?(this.version<800&&this.raiseError("PHP 8+ is required to use named arguments"),this.node("namedargument")(this.text(),this.next().next().read_expr())):this.read_expr()},read_type(){let t=this.node();if(this.token===this.tok.T_ARRAY||this.token===this.tok.T_CALLABLE){let e=this.text();return this.next(),t("typereference",e.toLowerCase(),e)}else if(this.token===this.tok.T_NAME_RELATIVE||this.token===this.tok.T_NAME_QUALIFIED||this.token===this.tok.T_NAME_FULLY_QUALIFIED||this.token===this.tok.T_STRING||this.token===this.tok.T_STATIC){let e=this.text(),s=[this.token,this.lexer.getState()];return this.next(),this.token!==this.tok.T_NS_SEPARATOR&&this.ast.typereference.types.indexOf(e.toLowerCase())>-1?t("typereference",e.toLowerCase(),e):(this.lexer.tokens.push(s),this.next(),t.destroy(),this.read_namespace_name())}return t.destroy(),null}}});var le=h((Tu,ce)=>{"use strict";ce.exports={read_if(){let t=this.node("if"),e=this.next().read_if_expr(),s=null,i=null,n=!1;if(this.token===":"){n=!0,this.next(),s=this.node("block");let r=[];for(;this.token!==this.EOF&&this.token!==this.tok.T_ENDIF;){if(this.token===this.tok.T_ELSEIF){i=this.read_elseif_short();break}else if(this.token===this.tok.T_ELSE){i=this.read_else_short();break}r.push(this.read_inner_statement())}s=s(null,r),this.expect(this.tok.T_ENDIF)&&this.next(),this.expectEndOfStatement()}else s=this.read_statement(),this.token===this.tok.T_ELSEIF?i=this.read_if():this.token===this.tok.T_ELSE&&(i=this.next().read_statement());return t(e,s,i,n)},read_if_expr(){this.expect("(")&&this.next();let t=this.read_expr();return this.expect(")")&&this.next(),t},read_elseif_short(){let t=null,e=this.node("if"),s=this.next().read_if_expr();this.expect(":")&&this.next();let i=this.node("block"),n=[];for(;this.token!=this.EOF&&this.token!==this.tok.T_ENDIF;){if(this.token===this.tok.T_ELSEIF){t=this.read_elseif_short();break}else if(this.token===this.tok.T_ELSE){t=this.read_else_short();break}n.push(this.read_inner_statement())}return e(s,i(null,n),t,!0)},read_else_short(){this.next().expect(":")&&this.next();let t=this.node("block"),e=[];for(;this.token!=this.EOF&&this.token!==this.tok.T_ENDIF;)e.push(this.read_inner_statement());return t(null,e)}}});var ue=h((du,_e)=>{"use strict";_e.exports={read_while(){let t=this.node("while");this.expect(this.tok.T_WHILE)&&this.next();let e=null,s=null,i=!1;return this.expect("(")&&this.next(),e=this.read_expr(),this.expect(")")&&this.next(),this.token===":"?(i=!0,s=this.read_short_form(this.tok.T_ENDWHILE)):s=this.read_statement(),t(e,s,i)},read_do(){let t=this.node("do");this.expect(this.tok.T_DO)&&this.next();let e=null,s=null;return s=this.read_statement(),this.expect(this.tok.T_WHILE)&&(this.next().expect("(")&&this.next(),e=this.read_expr(),this.expect(")")&&this.next(),this.expect(";")&&this.next()),t(e,s)},read_for(){let t=this.node("for");this.expect(this.tok.T_FOR)&&this.next();let e=[],s=[],i=[],n=null,r=!1;return this.expect("(")&&this.next(),this.token!==";"?(e=this.read_list(this.read_expr,","),this.expect(";")&&this.next()):this.next(),this.token!==";"?(s=this.read_list(this.read_expr,","),this.expect(";")&&this.next()):this.next(),this.token!==")"?(i=this.read_list(this.read_expr,","),this.expect(")")&&this.next()):this.next(),this.token===":"?(r=!0,n=this.read_short_form(this.tok.T_ENDFOR)):n=this.read_statement(),t(e,s,i,n,r)},read_foreach(){let t=this.node("foreach");this.expect(this.tok.T_FOREACH)&&this.next();let e=null,s=null,i=null,n=null,r=!1;return this.expect("(")&&this.next(),e=this.read_expr(),this.expect(this.tok.T_AS)&&(this.next(),i=this.read_foreach_variable(),this.token===this.tok.T_DOUBLE_ARROW&&(s=i,i=this.next().read_foreach_variable())),s&&s.kind==="list"&&this.raiseError("Fatal Error : Cannot use list as key element"),this.expect(")")&&this.next(),this.token===":"?(r=!0,n=this.read_short_form(this.tok.T_ENDFOREACH)):n=this.read_statement(),t(e,s,i,n,r)},read_foreach_variable(){if(this.token===this.tok.T_LIST||this.token==="["){let t=this.token==="[",e=this.node("list");this.next(),!t&&this.expect("(")&&this.next();let s=this.read_array_pair_list(t);return this.expect(t?"]":")")&&this.next(),e(s,t)}else return this.read_variable(!1,!1)}}});var pe=h((ku,fe)=>{"use strict";fe.exports={read_start(){return this.token==this.tok.T_NAMESPACE?this.read_namespace():this.read_top_statement()}}});var de=h((xu,Te)=>{"use strict";Te.exports={read_namespace(){let t=this.node("namespace"),e;this.expect(this.tok.T_NAMESPACE)&&this.next();let s;return this.token==="{"?s={name:[""]}:s=this.read_namespace_name(),this.currentNamespace=s,this.token===";"?(this.currentNamespace=s,e=this.next().read_top_statements(),this.expect(this.EOF),t(s.name,e,!1)):this.token==="{"?(this.currentNamespace=s,e=this.next().read_top_statements(),this.expect("}")&&this.next(),e.length===0&&this.extractDoc&&this._docs.length>this._docIndex&&e.push(this.node("noop")()),t(s.name,e,!0)):(this.error(["{",";"]),this.currentNamespace=s,e=this.read_top_statements(),this.expect(this.EOF),t(s,e,!1))},read_namespace_name(t){let e=this.node(),s,i=this.text();switch(this.token){case this.tok.T_NAME_RELATIVE:s=this.ast.name.RELATIVE_NAME,i=i.replace(/^namespace\\/,"");break;case this.tok.T_NAME_QUALIFIED:s=this.ast.name.QUALIFIED_NAME;break;case this.tok.T_NAME_FULLY_QUALIFIED:s=this.ast.name.FULL_QUALIFIED_NAME;break;default:if(s=this.ast.name.UNQUALIFIED_NAME,!this.expect(this.tok.T_STRING))return e("name","",this.ast.name.FULL_QUALIFIED_NAME)}if(this.next(),t||this.token!=="("){if(i.toLowerCase()==="parent")return e("parentreference",i);if(i.toLowerCase()==="self")return e("selfreference",i)}return e("name",i,s)},read_use_statement(){let t=this.node("usegroup"),e=[],s=null;this.expect(this.tok.T_USE)&&this.next();let i=this.read_use_type();return e.push(this.read_use_declaration(!1)),this.token===","?e=e.concat(this.next().read_use_declarations(!1)):this.token==="{"&&(s=e[0].name,e=this.next().read_use_declarations(i===null),this.expect("}")&&this.next()),t=t(s,i,e),this.expect(";")&&this.next(),t},read_class_name_reference(){return this.read_variable(!0,!1)},read_use_declaration(t){let e=this.node("useitem"),s=null;t&&(s=this.read_use_type());let i=this.read_namespace_name(),n=this.read_use_alias();return e(i.name,n,s)},read_use_declarations(t){let e=[this.read_use_declaration(t)];for(;this.token===",";){if(this.next(),t){if(this.token!==this.tok.T_NAME_RELATIVE&&this.token!==this.tok.T_NAME_QUALIFIED&&this.token!==this.tok.T_NAME_FULLY_QUALIFIED&&this.token!==this.tok.T_FUNCTION&&this.token!==this.tok.T_CONST&&this.token!==this.tok.T_STRING)break}else if(this.token!==this.tok.T_NAME_RELATIVE&&this.token!==this.tok.T_NAME_QUALIFIED&&this.token!==this.tok.T_NAME_FULLY_QUALIFIED&&this.token!==this.tok.T_STRING&&this.token!==this.tok.T_NS_SEPARATOR)break;e.push(this.read_use_declaration(t))}return e},read_use_alias(){let t=null;if(this.token===this.tok.T_AS&&this.next().expect(this.tok.T_STRING)){let e=this.node("identifier"),s=this.text();this.next(),t=e(s)}return t},read_use_type(){return this.token===this.tok.T_FUNCTION?(this.next(),this.ast.useitem.TYPE_FUNCTION):this.token===this.tok.T_CONST?(this.next(),this.ast.useitem.TYPE_CONST):null}}});var Ee=h((Eu,xe)=>{"use strict";var ke={"\\":"\\",$:"$",n:`
`,r:"\r",t:"	",f:"\f",v:"\v",e:"\x1B"};xe.exports={resolve_special_chars(t,e){return e?t.replace(/\\"/,'"').replace(/\\([\\$nrtfve]|[xX][0-9a-fA-F]{1,2}|[0-7]{1,3}|u{([0-9a-fA-F]+)})/g,(s,i,n)=>ke[i]?ke[i]:i[0]==="x"||i[0]==="X"?String.fromCodePoint(parseInt(i.substr(1),16)):i[0]==="u"?String.fromCodePoint(parseInt(n,16)):String.fromCodePoint(parseInt(i,8))):t.replace(/\\\\/g,"\\").replace(/\\'/g,"'")},remove_heredoc_leading_whitespace_chars(t,e,s,i){if(e===0)return t;this.check_heredoc_indentation_level(t,e,s,i);let n=s?" ":"	",r=new RegExp(`\\n${n}{${e}}`,"g"),o=new RegExp(`^${n}{${e}}`);return i&&(t=t.replace(o,"")),t.replace(r,`
`)},check_heredoc_indentation_level(t,e,s,i){let n=t.length,r=0,o=0,a=!0,c=s?" ":"	",l=!1;if(!i){if(r=t.indexOf(`
`),r===-1)return;r++}for(;r<n;)a?t[r]===c?o++:l=!0:a=!1,t[r]!==`
`&&l&&o<e?this.raiseError(`Invalid body indentation level (expecting an indentation at least ${e})`):l=!1,t[r]===`
`&&(a=!0,o=0),r++},read_dereferencable_scalar(){let t=null;switch(this.token){case this.tok.T_CONSTANT_ENCAPSED_STRING:{let e=this.node("string"),s=this.text(),i=0;(s[0]==="b"||s[0]==="B")&&(i=1);let n=s[i]==='"';this.next();let r=this.resolve_special_chars(s.substring(i+1,s.length-1),n);e=e(n,r,i===1,s),this.token===this.tok.T_DOUBLE_COLON?t=this.read_static_getter(e):t=e}break;case this.tok.T_ARRAY:t=this.read_array();break;case"[":t=this.read_array();break}return t},read_scalar(){if(this.is("T_MAGIC_CONST"))return this.get_magic_constant();{let t,e;switch(this.token){case this.tok.T_LNUMBER:case this.tok.T_DNUMBER:{let s=this.node("number");return t=this.text(),this.next(),s(t,null)}case this.tok.T_START_HEREDOC:if(this.lexer.curCondition==="ST_NOWDOC"){let s=this.lexer.yylloc.first_offset;e=this.node("nowdoc"),t=this.next().text(),this.lexer.heredoc_label.indentation>0&&(t=t.substring(0,t.length-this.lexer.heredoc_label.indentation));let i=t[t.length-1];i===`
`?t[t.length-2]==="\r"?t=t.substring(0,t.length-2):t=t.substring(0,t.length-1):i==="\r"&&(t=t.substring(0,t.length-1)),this.expect(this.tok.T_ENCAPSED_AND_WHITESPACE)&&this.next(),this.expect(this.tok.T_END_HEREDOC)&&this.next();let n=this.lexer._input.substring(s,this.lexer.yylloc.first_offset);return e=e(this.remove_heredoc_leading_whitespace_chars(t,this.lexer.heredoc_label.indentation,this.lexer.heredoc_label.indentation_uses_spaces,this.lexer.heredoc_label.first_encaps_node),n,this.lexer.heredoc_label.label),this.lexer.heredoc_label.finished=!0,e}else return this.read_encapsed_string(this.tok.T_END_HEREDOC);case'"':return this.read_encapsed_string('"');case'b"':case'B"':return this.read_encapsed_string('"',!0);case this.tok.T_CONSTANT_ENCAPSED_STRING:case this.tok.T_ARRAY:case"[":return this.read_dereferencable_scalar();default:{let s=this.error("SCALAR");return this.next(),s}}}},read_dereferencable(t){let e,s,i=this.node("offsetlookup");return this.token==="["?(s=this.next().read_expr(),this.expect("]")&&this.next(),e=i(t,s)):this.token===this.tok.T_DOLLAR_OPEN_CURLY_BRACES&&(s=this.read_encapsed_string_item(!1),e=i(t,s)),e},read_encapsed_string_item(t){let e=this.node("encapsedpart"),s=null,i=!1,n=this.node(),r,o,a;if(this.token===this.tok.T_ENCAPSED_AND_WHITESPACE){let c=this.text();this.next(),n=n("string",!1,this.version>=703&&!this.lexer.heredoc_label.finished?this.remove_heredoc_leading_whitespace_chars(this.resolve_special_chars(c,t),this.lexer.heredoc_label.indentation,this.lexer.heredoc_label.indentation_uses_spaces,this.lexer.heredoc_label.first_encaps_node):c,!1,c)}else if(this.token===this.tok.T_DOLLAR_OPEN_CURLY_BRACES){if(s="simple",i=!0,a=null,this.next().token===this.tok.T_STRING_VARNAME){a=this.node("variable");let c=this.text();this.next(),n.destroy(),this.token==="["?(a=a(c,!1),o=this.node("offsetlookup"),r=this.next().read_expr(),this.expect("]")&&this.next(),n=o(a,r)):n=a(c,!1)}else n=n("variable",this.read_expr(),!1);this.expect("}")&&this.next()}else if(this.token===this.tok.T_CURLY_OPEN)s="complex",n.destroy(),n=this.next().read_variable(!1,!1),this.expect("}")&&this.next();else if(this.token===this.tok.T_VARIABLE){if(s="simple",n.destroy(),n=this.read_simple_variable(),this.token==="["&&(o=this.node("offsetlookup"),r=this.next().read_encaps_var_offset(),this.expect("]")&&this.next(),n=o(n,r)),this.token===this.tok.T_OBJECT_OPERATOR){o=this.node("propertylookup"),this.next().expect(this.tok.T_STRING);let c=this.node("identifier");a=this.text(),this.next(),n=o(n,c(a))}}else{this.expect(this.tok.T_ENCAPSED_AND_WHITESPACE);let c=this.text();this.next(),n.destroy(),n=n("string",!1,c,!1,c)}return this.lexer.heredoc_label.first_encaps_node=!1,e(n,s,i)},read_encapsed_string(t,e=!1){let s=this.lexer.yylloc.first_offset,i=this.node("encapsed");this.next();let n=this.lexer.yylloc.prev_offset-(e?1:0),r=[],o=null;for(t==="`"?o=this.ast.encapsed.TYPE_SHELL:t==='"'?o=this.ast.encapsed.TYPE_STRING:o=this.ast.encapsed.TYPE_HEREDOC;this.token!==t&&this.token!==this.EOF;)r.push(this.read_encapsed_string_item(!0));if(r.length>0&&r[r.length-1].kind==="encapsedpart"&&r[r.length-1].expression.kind==="string"){let c=r[r.length-1].expression,l=c.value[c.value.length-1];l===`
`?c.value[c.value.length-2]==="\r"?c.value=c.value.substring(0,c.value.length-2):c.value=c.value.substring(0,c.value.length-1):l==="\r"&&(c.value=c.value.substring(0,c.value.length-1))}this.expect(t)&&this.next();let a=this.lexer._input.substring(o==="heredoc"?s:n-1,this.lexer.yylloc.first_offset);return i=i(r,a,o),t===this.tok.T_END_HEREDOC&&(i.label=this.lexer.heredoc_label.label,this.lexer.heredoc_label.finished=!0),i},get_magic_constant(){let t=this.node("magic"),e=this.text();return this.next(),t(e.toUpperCase(),e)}}});var Ne=h((Au,Ae)=>{"use strict";Ae.exports={read_top_statements(){let t=[];for(;this.token!==this.EOF&&this.token!=="}";){let e=this.read_top_statement();e&&(Array.isArray(e)?t=t.concat(e):t.push(e))}return t},read_top_statement(){let t=[];switch(this.token===this.tok.T_ATTRIBUTE&&(t=this.read_attr_list()),this.token){case this.tok.T_FUNCTION:return this.read_function(!1,!1,t);case this.tok.T_ABSTRACT:case this.tok.T_FINAL:case this.tok.T_READ_ONLY:case this.tok.T_CLASS:return this.read_class_declaration_statement(t);case this.tok.T_INTERFACE:return this.read_interface_declaration_statement(t);case this.tok.T_TRAIT:return this.read_trait_declaration_statement();case this.tok.T_ENUM:return this.read_enum_declaration_statement(t);case this.tok.T_USE:return this.read_use_statement();case this.tok.T_CONST:{let e=this.node("constantstatement"),s=this.next().read_const_list();return this.expectEndOfStatement(),e(null,s)}case this.tok.T_NAMESPACE:return this.read_namespace();case this.tok.T_HALT_COMPILER:{let e=this.node("halt");return this.next().expect("(")&&this.next(),this.expect(")")&&this.next(),this.expect(";"),this.lexer.done=!0,e(this.lexer._input.substring(this.lexer.offset))}default:return this.read_statement()}},read_inner_statements(){let t=[];for(;this.token!=this.EOF&&this.token!=="}";){let e=this.read_inner_statement();e&&(Array.isArray(e)?t=t.concat(e):t.push(e))}return t},read_const_list(){return this.read_list(function(){this.expect(this.tok.T_STRING);let t=this.node("constant"),e=this.node("identifier"),s=this.text();return this.next(),e=e(s),this.expect("=")?t(e,this.next().read_expr()):t(e,null)},",",!1)},read_declare_list(){let t=[];for(;this.token!=this.EOF&&this.token!==")";){this.expect(this.tok.T_STRING);let e=this.node("declaredirective"),s=this.node("identifier"),i=this.text();this.next(),s=s(i);let n=null;if(this.expect("=")&&(n=this.next().read_expr()),t.push(e(s,n)),this.token!==",")break;this.next()}return t},read_inner_statement(){let t=[];switch(this.token===this.tok.T_ATTRIBUTE&&(t=this.read_attr_list()),this.token){case this.tok.T_FUNCTION:{let e=this.read_function(!1,!1);return e.attrGroups=t,e}case this.tok.T_ABSTRACT:case this.tok.T_FINAL:case this.tok.T_CLASS:return this.read_class_declaration_statement();case this.tok.T_INTERFACE:return this.read_interface_declaration_statement();case this.tok.T_TRAIT:return this.read_trait_declaration_statement();case this.tok.T_ENUM:return this.read_enum_declaration_statement();case this.tok.T_HALT_COMPILER:{this.raiseError("__HALT_COMPILER() can only be used from the outermost scope");let e=this.node("halt");return this.next().expect("(")&&this.next(),this.expect(")")&&this.next(),e=e(this.lexer._input.substring(this.lexer.offset)),this.expect(";")&&this.next(),e}default:return this.read_statement()}},read_statement(){switch(this.token){case"{":return this.read_code_block(!1);case this.tok.T_IF:return this.read_if();case this.tok.T_SWITCH:return this.read_switch();case this.tok.T_FOR:return this.read_for();case this.tok.T_FOREACH:return this.read_foreach();case this.tok.T_WHILE:return this.read_while();case this.tok.T_DO:return this.read_do();case this.tok.T_COMMENT:return this.read_comment();case this.tok.T_DOC_COMMENT:return this.read_doc_comment();case this.tok.T_RETURN:{let t=this.node("return");this.next();let e=this.read_optional_expr(";");return this.expectEndOfStatement(),t(e)}case this.tok.T_BREAK:case this.tok.T_CONTINUE:{let t=this.node(this.token===this.tok.T_CONTINUE?"continue":"break");this.next();let e=this.read_optional_expr(";");return this.expectEndOfStatement(),t(e)}case this.tok.T_GLOBAL:{let t=this.node("global"),e=this.next().read_list(this.read_simple_variable,",");return this.expectEndOfStatement(),t(e)}case this.tok.T_STATIC:{let t=[this.token,this.lexer.getState()],e=this.node();if(this.next().token===this.tok.T_DOUBLE_COLON){this.lexer.tokens.push(t);let i=this.next().read_expr();return this.expectEndOfStatement(i),e("expressionstatement",i)}if(this.token===this.tok.T_FUNCTION)return this.read_function(!0,[0,1,0]);let s=this.read_variable_declarations();return this.expectEndOfStatement(),e("static",s)}case this.tok.T_ECHO:{let t=this.node("echo"),e=this.text(),s=e==="<?="||e==="<%=",i=this.next().read_function_list(this.read_expr,",");return this.expectEndOfStatement(),t(i,s)}case this.tok.T_INLINE_HTML:{let t=this.text(),e=this.lexer.yylloc.first_offset>0?this.lexer._input[this.lexer.yylloc.first_offset-1]:null,s=e==="\r"||e===`
`;s&&e===`
`&&this.lexer.yylloc.first_offset>1&&this.lexer._input[this.lexer.yylloc.first_offset-2]==="\r"&&(e=`\r
`);let i=this.node("inline");return this.next(),i(t,s?e+t:t)}case this.tok.T_UNSET:{let t=this.node("unset");this.next().expect("(")&&this.next();let e=this.read_function_list(this.read_variable,",");return this.expect(")")&&this.next(),this.expect(";")&&this.next(),t(e)}case this.tok.T_DECLARE:{let t=this.node("declare"),e=[],s;this.next().expect("(")&&this.next();let i=this.read_declare_list();if(this.expect(")")&&this.next(),this.token===":"){for(this.next();this.token!=this.EOF&&this.token!==this.tok.T_ENDDECLARE;)e.push(this.read_top_statement());e.length===0&&this.extractDoc&&this._docs.length>this._docIndex&&e.push(this.node("noop")()),this.expect(this.tok.T_ENDDECLARE)&&this.next(),this.expectEndOfStatement(),s=this.ast.declare.MODE_SHORT}else if(this.token==="{"){for(this.next();this.token!=this.EOF&&this.token!=="}";)e.push(this.read_top_statement());e.length===0&&this.extractDoc&&this._docs.length>this._docIndex&&e.push(this.node("noop")()),this.expect("}")&&this.next(),s=this.ast.declare.MODE_BLOCK}else this.expect(";")&&this.next(),s=this.ast.declare.MODE_NONE;return t(i,e,s)}case this.tok.T_TRY:return this.read_try();case this.tok.T_THROW:{let t=this.node("throw"),e=this.next().read_expr();return this.expectEndOfStatement(),t(e)}case";":return this.next(),null;case this.tok.T_STRING:{let t=this.node(),e=[this.token,this.lexer.getState()],s=this.text(),i=this.node("identifier");if(this.next().token===":")return i=i(s),this.next(),t("label",i);i.destroy(),t.destroy(),this.lexer.tokens.push(e);let n=this.node("expressionstatement"),r=this.next().read_expr();return this.expectEndOfStatement(r),n(r)}case this.tok.T_GOTO:{let t=this.node("goto"),e=null;if(this.next().expect(this.tok.T_STRING)){e=this.node("identifier");let s=this.text();this.next(),e=e(s),this.expectEndOfStatement()}return t(e)}default:{let t=this.node("expressionstatement"),e=this.read_expr();return this.expectEndOfStatement(e),t(e)}}},read_code_block(t){let e=this.node("block");this.expect("{")&&this.next();let s=t?this.read_top_statements():this.read_inner_statements();return s.length===0&&this.extractDoc&&this._docs.length>this._docIndex&&s.push(this.node("noop")()),this.expect("}")&&this.next(),e(null,s)}}});var me=h((Nu,ye)=>{"use strict";ye.exports={read_switch(){let t=this.node("switch");this.expect(this.tok.T_SWITCH)&&this.next(),this.expect("(")&&this.next();let e=this.read_expr();this.expect(")")&&this.next();let s=this.token===":",i=this.read_switch_case_list();return t(e,i,s)},read_switch_case_list(){let t=null,e=this.node("block"),s=[];for(this.token==="{"?t="}":this.token===":"?t=this.tok.T_ENDSWITCH:this.expect(["{",":"]),this.next(),this.token===";"&&this.next();this.token!==this.EOF&&this.token!==t;)s.push(this.read_case_list(t));return s.length===0&&this.extractDoc&&this._docs.length>this._docIndex&&s.push(this.node("noop")()),this.expect(t)&&this.next(),t===this.tok.T_ENDSWITCH&&this.expectEndOfStatement(),e(null,s)},read_case_list(t){let e=this.node("case"),s=null;this.token===this.tok.T_CASE?s=this.next().read_expr():this.token===this.tok.T_DEFAULT?this.next():this.expect([this.tok.T_CASE,this.tok.T_DEFAULT]),this.expect([":",";"])&&this.next();let i=this.node("block"),n=[];for(;this.token!==this.EOF&&this.token!==t&&this.token!==this.tok.T_CASE&&this.token!==this.tok.T_DEFAULT;)n.push(this.read_inner_statement());return e(s,i(null,n))}}});var Ce=h((yu,Ie)=>{"use strict";Ie.exports={read_try(){this.expect(this.tok.T_TRY);let t=this.node("try"),e=null,s=[],i=this.next().read_statement();for(;this.token===this.tok.T_CATCH;){let n=this.node("catch");this.next().expect("(")&&this.next();let r=this.read_list(this.read_namespace_name,"|",!1),o=null;(this.version<800||this.token===this.tok.T_VARIABLE)&&(o=this.read_variable(!0,!1)),this.expect(")"),s.push(n(this.next().read_statement(),r,o))}return this.token===this.tok.T_FINALLY&&(e=this.next().read_statement()),t(i,s,e)}}});var Se=h((mu,Le)=>{"use strict";Le.exports={read_short_form(t){let e=this.node("block"),s=[];for(this.expect(":")&&this.next();this.token!=this.EOF&&this.token!==t;)s.push(this.read_inner_statement());return s.length===0&&this.extractDoc&&this._docs.length>this._docIndex&&s.push(this.node("noop")()),this.expect(t)&&this.next(),this.expectEndOfStatement(),e(null,s)},read_function_list(t,e){let s=[];do{if(this.token==e&&this.version>=703&&s.length>0){s.push(this.node("noop")());break}if(s.push(t.apply(this,[])),this.token!=e||this.next().token==")"&&this.version>=703)break}while(this.token!=this.EOF);return s},read_list(t,e,s){let i=[];if(this.token==e&&(s&&i.push(typeof t=="function"?this.node("noop")():null),this.next()),typeof t=="function")do{let n=t.apply(this,[]);if(n&&i.push(n),this.token!=e)break}while(this.next().token!=this.EOF);else{if(this.expect(t))i.push(this.text());else return[];for(;this.next().token!=this.EOF&&!(this.token!=e||this.next().token!=t);)i.push(this.text())}return i},read_name_list(){return this.read_list(this.read_namespace_name,",",!1)},read_byref(t){let e=this.node("byref");this.next(),e=e(null);let s=t();return s&&(this.ast.swapLocations(s,e,s,this),s.byref=!0),s},read_variable_declarations(){return this.read_list(function(){let t=this.node("staticvariable"),e=this.node("variable");if(this.expect(this.tok.T_VARIABLE)){let s=this.text().substring(1);this.next(),e=e(s,!1)}else e=e("#ERR",!1);return this.token==="="?t(e,this.next().read_expr()):e},",")},read_extends_from(){return this.token===this.tok.T_EXTENDS?this.next().read_namespace_name():null},read_interface_extends_list(){return this.token===this.tok.T_EXTENDS?this.next().read_name_list():null},read_implements_list(){return this.token===this.tok.T_IMPLEMENTS?this.next().read_name_list():null}}});var Oe=h((Iu,Re)=>{"use strict";Re.exports={read_variable(t,e){let s;if(this.token==="&")return this.read_byref(this.read_variable.bind(this,t,e));if(this.is([this.tok.T_VARIABLE,"$"]))s=this.read_reference_variable(e);else if(this.is([this.tok.T_NS_SEPARATOR,this.tok.T_STRING,this.tok.T_NAME_RELATIVE,this.tok.T_NAME_QUALIFIED,this.tok.T_NAME_FULLY_QUALIFIED,this.tok.T_NAMESPACE])){s=this.node();let i=this.read_namespace_name();if(this.token!=this.tok.T_DOUBLE_COLON&&this.token!="("&&["parentreference","selfreference"].indexOf(i.kind)===-1){let n=i.name.toLowerCase();n==="true"?s=i.destroy(s("boolean",!0,i.name)):n==="false"?s=i.destroy(s("boolean",!1,i.name)):n==="null"?s=i.destroy(s("nullkeyword",i.name)):(s.destroy(i),s=i)}else s.destroy(i),s=i}else if(this.token===this.tok.T_STATIC){s=this.node("staticreference");let i=this.text();this.next(),s=s(i)}else this.expect("VARIABLE");return this.token===this.tok.T_DOUBLE_COLON&&(s=this.read_static_getter(s,e)),this.recursive_variable_chain_scan(s,t,e)},read_static_getter(t,e){let s=this.node("staticlookup"),i,n;return this.next().is([this.tok.T_VARIABLE,"$"])?i=this.read_reference_variable(e):this.token===this.tok.T_STRING||this.token===this.tok.T_CLASS||this.version>=700&&this.is("IDENTIFIER")?(i=this.node("identifier"),n=this.text(),this.next(),i=i(n)):this.token==="{"?(i=this.node("literal"),n=this.next().read_expr(),this.expect("}")&&this.next(),i=i("literal",n,null),this.expect("(")):(this.error([this.tok.T_VARIABLE,this.tok.T_STRING]),i=this.node("identifier"),n=this.text(),this.next(),i=i(n)),s(t,i)},read_what(t=!1){let e=null,s=null;switch(this.next().token){case this.tok.T_STRING:e=this.node("identifier"),s=this.text(),this.next(),e=e(s),t&&this.token===this.tok.T_OBJECT_OPERATOR&&this.error();break;case this.tok.T_VARIABLE:e=this.node("variable"),s=this.text().substring(1),this.next(),e=e(s,!1);break;case"$":e=this.node(),this.next().expect(["$","{",this.tok.T_VARIABLE]),this.token==="{"?(s=this.next().read_expr(),this.expect("}")&&this.next(),e=e("variable",s,!0)):(s=this.read_expr(),e=e("variable",s,!1));break;case"{":e=this.node("encapsedpart"),s=this.next().read_expr(),this.expect("}")&&this.next(),e=e(s,"complex",!1);break;default:this.error([this.tok.T_STRING,this.tok.T_VARIABLE,"$","{"]),e=this.node("identifier"),s=this.text(),this.next(),e=e(s);break}return e},recursive_variable_chain_scan(t,e,s){let i,n;t:for(;this.token!=this.EOF;)switch(this.token){case"(":if(e)return t;t=this.node("call")(t,this.read_argument_list());break;case"[":case"{":{let o=this.token==="[";i=this.node("offsetlookup"),this.next(),n=!1,s?(n=this.read_encaps_var_offset(),this.expect(o?"]":"}")&&this.next()):(o?this.token!=="]":this.token!=="}")?(n=this.read_expr(),this.expect(o?"]":"}")&&this.next()):this.next(),t=i(t,n);break}case this.tok.T_DOUBLE_COLON:t.kind==="staticlookup"&&t.offset.kind==="identifier"&&this.error(),i=this.node("staticlookup"),t=i(t,this.read_what(!0));break;case this.tok.T_OBJECT_OPERATOR:{i=this.node("propertylookup"),t=i(t,this.read_what());break}case this.tok.T_NULLSAFE_OBJECT_OPERATOR:{i=this.node("nullsafepropertylookup"),t=i(t,this.read_what());break}default:break t}return t},read_encaps_var_offset(){let t=this.node();if(this.token===this.tok.T_STRING){let e=this.text();this.next(),t=t("identifier",e)}else if(this.token===this.tok.T_NUM_STRING){let e=this.text();this.next(),t=t("number",e,null)}else if(this.token==="-"){this.next();let e=-1*this.text();this.expect(this.tok.T_NUM_STRING)&&this.next(),t=t("number",e,null)}else if(this.token===this.tok.T_VARIABLE){let e=this.text().substring(1);this.next(),t=t("variable",e,!1)}else{this.expect([this.tok.T_STRING,this.tok.T_NUM_STRING,"-",this.tok.T_VARIABLE]);let e=this.text();this.next(),t=t("identifier",e)}return t},read_reference_variable(t){let e=this.read_simple_variable(),s;for(;this.token!=this.EOF;){let i=this.node();if(this.token=="{"&&!t)s=this.next().read_expr(),this.expect("}")&&this.next(),e=i("offsetlookup",e,s);else{i.destroy();break}}return e},read_simple_variable(){let t=this.node("variable"),e;if(this.expect([this.tok.T_VARIABLE,"$"])&&this.token===this.tok.T_VARIABLE)e=this.text().substring(1),this.next(),t=t(e,!1);else switch(this.token==="$"&&this.next(),this.token){case"{":{let s=this.next().read_expr();this.expect("}")&&this.next(),t=t(s,!0);break}case"$":t=t(this.read_simple_variable(),!1);break;case this.tok.T_VARIABLE:{e=this.text().substring(1);let s=this.node("variable");this.next(),t=t(s(e,!1),!1);break}default:this.error(["{","$",this.tok.T_VARIABLE]),e=this.text(),this.next(),t=t(e,!1)}return t}}});var ge=h((Cu,be)=>{"use strict";var Hl=it();function rt(t){return t!="."&&t!=","&&!isNaN(parseFloat(t))&&isFinite(t)}var d=function(t,e){this.lexer=t,this.ast=e,this.tok=t.tok,this.EOF=t.EOF,this.token=null,this.prev=null,this.debug=!1,this.version=803,this.extractDoc=!1,this.extractTokens=!1,this.suppressErrors=!1;let s=function(i){return[i,null]};this.entries={IDENTIFIER:new Map([this.tok.T_ABSTRACT,this.tok.T_ARRAY,this.tok.T_AS,this.tok.T_BREAK,this.tok.T_CALLABLE,this.tok.T_CASE,this.tok.T_CATCH,this.tok.T_CLASS,this.tok.T_CLASS_C,this.tok.T_CLONE,this.tok.T_CONST,this.tok.T_CONTINUE,this.tok.T_DECLARE,this.tok.T_DEFAULT,this.tok.T_DIR,this.tok.T_DO,this.tok.T_ECHO,this.tok.T_ELSE,this.tok.T_ELSEIF,this.tok.T_EMPTY,this.tok.T_ENDDECLARE,this.tok.T_ENDFOR,this.tok.T_ENDFOREACH,this.tok.T_ENDIF,this.tok.T_ENDSWITCH,this.tok.T_ENDWHILE,this.tok.T_ENUM,this.tok.T_EVAL,this.tok.T_EXIT,this.tok.T_EXTENDS,this.tok.T_FILE,this.tok.T_FINAL,this.tok.T_FINALLY,this.tok.T_FN,this.tok.T_FOR,this.tok.T_FOREACH,this.tok.T_FUNC_C,this.tok.T_FUNCTION,this.tok.T_GLOBAL,this.tok.T_GOTO,this.tok.T_IF,this.tok.T_IMPLEMENTS,this.tok.T_INCLUDE,this.tok.T_INCLUDE_ONCE,this.tok.T_INSTANCEOF,this.tok.T_INSTEADOF,this.tok.T_INTERFACE,this.tok.T_ISSET,this.tok.T_LINE,this.tok.T_LIST,this.tok.T_LOGICAL_AND,this.tok.T_LOGICAL_OR,this.tok.T_LOGICAL_XOR,this.tok.T_MATCH,this.tok.T_METHOD_C,this.tok.T_NAMESPACE,this.tok.T_NEW,this.tok.T_NS_C,this.tok.T_PRINT,this.tok.T_PRIVATE,this.tok.T_PROTECTED,this.tok.T_PUBLIC,this.tok.T_READ_ONLY,this.tok.T_REQUIRE,this.tok.T_REQUIRE_ONCE,this.tok.T_RETURN,this.tok.T_STATIC,this.tok.T_SWITCH,this.tok.T_THROW,this.tok.T_TRAIT,this.tok.T_TRY,this.tok.T_UNSET,this.tok.T_USE,this.tok.T_VAR,this.tok.T_WHILE,this.tok.T_YIELD].map(s)),VARIABLE:new Map([this.tok.T_VARIABLE,"$","&",this.tok.T_STRING,this.tok.T_NAME_RELATIVE,this.tok.T_NAME_QUALIFIED,this.tok.T_NAME_FULLY_QUALIFIED,this.tok.T_NAMESPACE,this.tok.T_STATIC].map(s)),SCALAR:new Map([this.tok.T_CONSTANT_ENCAPSED_STRING,this.tok.T_START_HEREDOC,this.tok.T_LNUMBER,this.tok.T_DNUMBER,this.tok.T_ARRAY,"[",this.tok.T_CLASS_C,this.tok.T_TRAIT_C,this.tok.T_FUNC_C,this.tok.T_METHOD_C,this.tok.T_LINE,this.tok.T_FILE,this.tok.T_DIR,this.tok.T_NS_C,'"','b"','B"',"-",this.tok.T_NS_SEPARATOR].map(s)),T_MAGIC_CONST:new Map([this.tok.T_CLASS_C,this.tok.T_TRAIT_C,this.tok.T_FUNC_C,this.tok.T_METHOD_C,this.tok.T_LINE,this.tok.T_FILE,this.tok.T_DIR,this.tok.T_NS_C].map(s)),T_MEMBER_FLAGS:new Map([this.tok.T_PUBLIC,this.tok.T_PRIVATE,this.tok.T_PROTECTED,this.tok.T_STATIC,this.tok.T_ABSTRACT,this.tok.T_FINAL].map(s)),EOS:new Map([";",this.EOF,this.tok.T_INLINE_HTML].map(s)),EXPR:new Map(["@","-","+","!","~","(","`",this.tok.T_LIST,this.tok.T_CLONE,this.tok.T_INC,this.tok.T_DEC,this.tok.T_NEW,this.tok.T_ISSET,this.tok.T_EMPTY,this.tok.T_MATCH,this.tok.T_INCLUDE,this.tok.T_INCLUDE_ONCE,this.tok.T_REQUIRE,this.tok.T_REQUIRE_ONCE,this.tok.T_EVAL,this.tok.T_INT_CAST,this.tok.T_DOUBLE_CAST,this.tok.T_STRING_CAST,this.tok.T_ARRAY_CAST,this.tok.T_OBJECT_CAST,this.tok.T_BOOL_CAST,this.tok.T_UNSET_CAST,this.tok.T_EXIT,this.tok.T_PRINT,this.tok.T_YIELD,this.tok.T_STATIC,this.tok.T_FUNCTION,this.tok.T_FN,this.tok.T_VARIABLE,"$",this.tok.T_NS_SEPARATOR,this.tok.T_STRING,this.tok.T_NAME_RELATIVE,this.tok.T_NAME_QUALIFIED,this.tok.T_NAME_FULLY_QUALIFIED,this.tok.T_STRING,this.tok.T_CONSTANT_ENCAPSED_STRING,this.tok.T_START_HEREDOC,this.tok.T_LNUMBER,this.tok.T_DNUMBER,this.tok.T_ARRAY,"[",this.tok.T_CLASS_C,this.tok.T_TRAIT_C,this.tok.T_FUNC_C,this.tok.T_METHOD_C,this.tok.T_LINE,this.tok.T_FILE,this.tok.T_DIR,this.tok.T_NS_C,'"','b"','B"',"-",this.tok.T_NS_SEPARATOR].map(s))}};d.prototype.getTokenName=function(t){return rt(t)?t==this.EOF?"the end of file (EOF)":this.lexer.engine.tokens.values[t]:"'"+t+"'"};d.prototype.parse=function(t,e){this._errors=[],this.filename=e||"eval",this.currentNamespace=[""],this.extractDoc?this._docs=[]:this._docs=null,this.extractTokens?this._tokens=[]:this._tokens=null,this._docIndex=0,this._lastNode=null,this.lexer.setInput(t),this.lexer.all_tokens=this.extractTokens,this.lexer.comment_tokens=this.extractDoc,this.length=this.lexer._input.length,this.innerList=!1,this.innerListForm=!1;let s=this.node("program"),i=[];for(this.next();this.token!=this.EOF;)i.push(this.read_start());i.length===0&&this.extractDoc&&this._docs.length>this._docIndex&&i.push(this.node("noop")()),this.prev=[this.lexer.yylloc.last_line,this.lexer.yylloc.last_column,this.lexer.offset];let n=s(i,this._errors,this._docs,this._tokens);if(this.debug){let r=this.ast.checkNodes();if(r.length>0)throw r.forEach(function(o){o.position&&console.log("Node at line "+o.position.line+", column "+o.position.column),console.log(o.stack.join(`
`))}),new Error("Some nodes are not closed")}return n};d.prototype.raiseError=function(t,e,s,i){if(t+=" on line "+this.lexer.yylloc.first_line,!this.suppressErrors){let r=new SyntaxError(t,this.filename,this.lexer.yylloc.first_line);throw r.lineNumber=this.lexer.yylloc.first_line,r.fileName=this.filename,r.columnNumber=this.lexer.yylloc.first_column,r}let n=this.ast.prepare("error",null,this)(t,i,this.lexer.yylloc.first_line,s);return this._errors.push(n),n};d.prototype.error=function(t){let e="Parse Error : syntax error",s=this.getTokenName(this.token),i="";if(this.token!==this.EOF){if(rt(this.token)){let n=this.text();n.length>10&&(n=n.substring(0,7)+"..."),s="'"+n+"' ("+s+")"}e+=", unexpected "+s}return t&&!Array.isArray(t)&&((rt(t)||t.length===1)&&(i=", expecting "+this.getTokenName(t)),e+=i),this.raiseError(e,i,t,s)};d.prototype.position=function(){return new Hl(this.lexer.yylloc.first_line,this.lexer.yylloc.first_column,this.lexer.yylloc.first_offset)};d.prototype.node=function(t){if(this.extractDoc){let e=null;this._docIndex<this._docs.length&&(e=this._docs.slice(this._docIndex),this._docIndex=this._docs.length,this.debug&&(console.log(new Error("Append docs on "+t)),console.log(e)));let s=this.ast.prepare(t,e,this);return s.postBuild=function(i){if(this._docIndex<this._docs.length)if(this._lastNode){let n=this.prev[2],r=this._docIndex;for(;r<this._docs.length&&!(this._docs[r].offset>n);r++);r>this._docIndex&&(this._lastNode.setTrailingComments(this._docs.slice(this._docIndex,r)),this._docIndex=r)}else this.token===this.EOF&&(i.setTrailingComments(this._docs.slice(this._docIndex)),this._docIndex=this._docs.length);this._lastNode=i}.bind(this),s}return this.ast.prepare(t,null,this)};d.prototype.expectEndOfStatement=function(t){if(this.token===";")t&&this.lexer.yytext===";"&&t.includeToken(this);else if(this.token!==this.tok.T_INLINE_HTML&&this.token!==this.EOF)return this.error(";"),!1;return this.next(),!0};var nt=["parser.next","parser.node","parser.showlog"];d.prototype.showlog=function(){let t=new Error().stack.split(`
`),e;for(let s=2;s<t.length;s++){e=t[s].trim();let i=!1;for(let n=0;n<nt.length;n++)if(e.substring(3,3+nt[n].length)===nt[n]){i=!0;break}if(!i)break}return console.log("Line "+this.lexer.yylloc.first_line+" : "+this.getTokenName(this.token)+">"+this.lexer.yytext+"< @-->"+e),this};d.prototype.expect=function(t){if(Array.isArray(t)){if(t.indexOf(this.token)===-1)return this.error(t),!1}else if(this.token!=t)return this.error(t),!1;return!0};d.prototype.text=function(){return this.lexer.yytext};d.prototype.next=function(){if((this.token!==";"||this.lexer.yytext===";")&&(this.prev=[this.lexer.yylloc.last_line,this.lexer.yylloc.last_column,this.lexer.offset]),this.lex(),this.debug&&this.showlog(),this.extractDoc)for(;this.token===this.tok.T_COMMENT||this.token===this.tok.T_DOC_COMMENT;)this.token===this.tok.T_COMMENT?this._docs.push(this.read_comment()):this._docs.push(this.read_doc_comment());return this};d.prototype.peek=function(){let t=this.lexer.getState(),e=this.lexer.lex();return this.lexer.setState(t),e};d.prototype.lex=function(){if(this.extractTokens)do{if(this.token=this.lexer.lex()||this.EOF,this.token===this.EOF)return this;let t=this.lexer.yytext;if(Object.prototype.hasOwnProperty.call(this.lexer.engine.tokens.values,this.token)?t=[this.lexer.engine.tokens.values[this.token],t,this.lexer.yylloc.first_line,this.lexer.yylloc.first_offset,this.lexer.offset]:t=[null,t,this.lexer.yylloc.first_line,this.lexer.yylloc.first_offset,this.lexer.offset],this._tokens.push(t),this.token===this.tok.T_CLOSE_TAG)return this.token=";",this;if(this.token===this.tok.T_OPEN_TAG_WITH_ECHO)return this.token=this.tok.T_ECHO,this}while(this.token===this.tok.T_WHITESPACE||!this.extractDoc&&(this.token===this.tok.T_COMMENT||this.token===this.tok.T_DOC_COMMENT)||this.token===this.tok.T_OPEN_TAG);else this.token=this.lexer.lex()||this.EOF;return this};d.prototype.is=function(t){return Array.isArray(t)?t.indexOf(this.token)!==-1:this.entries[t].has(this.token)};[Jt(),te(),se(),ne(),oe(),ae(),le(),ue(),pe(),de(),Ee(),Ne(),me(),Ce(),Se(),Oe()].forEach(function(t){for(let e in t){if(Object.prototype.hasOwnProperty.call(d.prototype,e))throw new Error("Function "+e+" is already defined - collision");d.prototype[e]=t[e]}});be.exports=d});var we=h((Lu,ve)=>{"use strict";var De={T_HALT_COMPILER:101,T_USE:102,T_ENCAPSED_AND_WHITESPACE:103,T_OBJECT_OPERATOR:104,T_STRING:105,T_DOLLAR_OPEN_CURLY_BRACES:106,T_STRING_VARNAME:107,T_CURLY_OPEN:108,T_NUM_STRING:109,T_ISSET:110,T_EMPTY:111,T_INCLUDE:112,T_INCLUDE_ONCE:113,T_EVAL:114,T_REQUIRE:115,T_REQUIRE_ONCE:116,T_NAMESPACE:117,T_NS_SEPARATOR:118,T_AS:119,T_IF:120,T_ENDIF:121,T_WHILE:122,T_DO:123,T_FOR:124,T_SWITCH:125,T_BREAK:126,T_CONTINUE:127,T_RETURN:128,T_GLOBAL:129,T_STATIC:130,T_ECHO:131,T_INLINE_HTML:132,T_UNSET:133,T_FOREACH:134,T_DECLARE:135,T_TRY:136,T_THROW:137,T_GOTO:138,T_FINALLY:139,T_CATCH:140,T_ENDDECLARE:141,T_LIST:142,T_CLONE:143,T_PLUS_EQUAL:144,T_MINUS_EQUAL:145,T_MUL_EQUAL:146,T_DIV_EQUAL:147,T_CONCAT_EQUAL:148,T_MOD_EQUAL:149,T_AND_EQUAL:150,T_OR_EQUAL:151,T_XOR_EQUAL:152,T_SL_EQUAL:153,T_SR_EQUAL:154,T_INC:155,T_DEC:156,T_BOOLEAN_OR:157,T_BOOLEAN_AND:158,T_LOGICAL_OR:159,T_LOGICAL_AND:160,T_LOGICAL_XOR:161,T_SL:162,T_SR:163,T_IS_IDENTICAL:164,T_IS_NOT_IDENTICAL:165,T_IS_EQUAL:166,T_IS_NOT_EQUAL:167,T_IS_SMALLER_OR_EQUAL:168,T_IS_GREATER_OR_EQUAL:169,T_INSTANCEOF:170,T_INT_CAST:171,T_DOUBLE_CAST:172,T_STRING_CAST:173,T_ARRAY_CAST:174,T_OBJECT_CAST:175,T_BOOL_CAST:176,T_UNSET_CAST:177,T_EXIT:178,T_PRINT:179,T_YIELD:180,T_YIELD_FROM:181,T_FUNCTION:182,T_DOUBLE_ARROW:183,T_DOUBLE_COLON:184,T_ARRAY:185,T_CALLABLE:186,T_CLASS:187,T_ABSTRACT:188,T_TRAIT:189,T_FINAL:190,T_EXTENDS:191,T_INTERFACE:192,T_IMPLEMENTS:193,T_VAR:194,T_PUBLIC:195,T_PROTECTED:196,T_PRIVATE:197,T_CONST:198,T_NEW:199,T_INSTEADOF:200,T_ELSEIF:201,T_ELSE:202,T_ENDSWITCH:203,T_CASE:204,T_DEFAULT:205,T_ENDFOR:206,T_ENDFOREACH:207,T_ENDWHILE:208,T_CONSTANT_ENCAPSED_STRING:209,T_LNUMBER:210,T_DNUMBER:211,T_LINE:212,T_FILE:213,T_DIR:214,T_TRAIT_C:215,T_METHOD_C:216,T_FUNC_C:217,T_NS_C:218,T_START_HEREDOC:219,T_END_HEREDOC:220,T_CLASS_C:221,T_VARIABLE:222,T_OPEN_TAG:223,T_OPEN_TAG_WITH_ECHO:224,T_CLOSE_TAG:225,T_WHITESPACE:226,T_COMMENT:227,T_DOC_COMMENT:228,T_ELLIPSIS:229,T_COALESCE:230,T_POW:231,T_POW_EQUAL:232,T_SPACESHIP:233,T_COALESCE_EQUAL:234,T_FN:235,T_NULLSAFE_OBJECT_OPERATOR:236,T_MATCH:237,T_ATTRIBUTE:238,T_ENUM:239,T_READ_ONLY:240,T_NAME_RELATIVE:241,T_NAME_QUALIFIED:242,T_NAME_FULLY_QUALIFIED:243},Kl={values:Object.entries(De).reduce((t,[e,s])=>({...t,[s]:e}),{}),names:De};ve.exports=Object.freeze(Kl)});var Pe=h((Su,Ue)=>{"use strict";var Vl=function(t,e,s){this.source=t,this.start=e,this.end=s};Ue.exports=Vl});var p=h((Ru,Fe)=>{"use strict";var w=function(e,s,i){this.kind=e,s&&(this.leadingComments=s),i&&(this.loc=i)};w.prototype.setTrailingComments=function(t){this.trailingComments=t};w.prototype.destroy=function(t){if(!t)throw new Error("Node already initialized, you must swap with another node");return this.leadingComments&&(t.leadingComments?t.leadingComments=Array.concat(this.leadingComments,t.leadingComments):t.leadingComments=this.leadingComments),this.trailingComments&&(t.trailingComments?t.trailingComments=Array.concat(this.trailingComments,t.trailingComments):t.trailingComments=this.trailingComments),t};w.prototype.includeToken=function(t){return this.loc&&(this.loc.end&&(this.loc.end.line=t.lexer.yylloc.last_line,this.loc.end.column=t.lexer.yylloc.last_column,this.loc.end.offset=t.lexer.offset),t.ast.withSource&&(this.loc.source=t.lexer._input.substring(this.loc.start.offset,t.lexer.offset))),this};w.extends=function(t,e){return e.prototype=Object.create(this.prototype),e.extends=this.extends,e.prototype.constructor=e,e.kind=t,e};Fe.exports=w});var _=h((Ou,Be)=>{"use strict";var Me=p(),qe="expression";Be.exports=Me.extends(qe,function(e,s,i){Me.apply(this,[e||qe,s,i])})});var Ve=h((bu,Ke)=>{"use strict";var Ge=_(),He="array";Ke.exports=Ge.extends(He,function(e,s,i,n){Ge.apply(this,[He,i,n]),this.items=s,this.shortForm=e})});var $e=h((gu,Ye)=>{"use strict";var We=_(),Qe="arrowfunc";Ye.exports=We.extends(Qe,function(e,s,i,n,r,o,a,c){We.apply(this,[Qe,a,c]),this.arguments=e,this.byref=s,this.body=i,this.type=n,this.nullable=r,this.isStatic=o||!1})});var Je=h((Du,Xe)=>{"use strict";var ze=_(),je="assign";Xe.exports=ze.extends(je,function(e,s,i,n,r){ze.apply(this,[je,n,r]),this.left=e,this.right=s,this.operator=i})});var ss=h((vu,es)=>{"use strict";var Ze=_(),ts="assignref";es.exports=Ze.extends(ts,function(e,s,i,n){Ze.apply(this,[ts,i,n]),this.left=e,this.right=s})});var os=h((wu,rs)=>{"use strict";var is=p(),ns="attribute";rs.exports=is.extends(ns,function(e,s,i,n){is.apply(this,[ns,i,n]),this.name=e,this.args=s})});var ls=h((Uu,cs)=>{"use strict";var hs=p(),as="attrgroup";cs.exports=hs.extends(as,function(e,s,i){hs.apply(this,[as,s,i]),this.attrs=e||[]})});var R=h((Pu,fs)=>{"use strict";var _s=_(),us="operation";fs.exports=_s.extends(us,function(e,s,i){_s.apply(this,[e||us,s,i])})});var ks=h((Fu,ds)=>{"use strict";var ps=R(),Ts="bin";ds.exports=ps.extends(Ts,function(e,s,i,n,r){ps.apply(this,[Ts,n,r]),this.type=e,this.left=s,this.right=i})});var u=h((Mu,As)=>{"use strict";var xs=p(),Es="statement";As.exports=xs.extends(Es,function(e,s,i){xs.apply(this,[e||Es,s,i])})});var U=h((qu,ms)=>{"use strict";var Ns=u(),ys="block";ms.exports=Ns.extends(ys,function(e,s,i,n){Ns.apply(this,[e||ys,i,n]),this.children=s.filter(Boolean)})});var C=h((Bu,Ls)=>{"use strict";var Is=_(),Cs="literal";Ls.exports=Is.extends(Cs,function(e,s,i,n,r){Is.apply(this,[e||Cs,n,r]),this.value=s,i&&(this.raw=i)})});var bs=h((Gu,Os)=>{"use strict";var Ss=C(),Rs="boolean";Os.exports=Ss.extends(Rs,function(e,s,i,n){Ss.apply(this,[Rs,e,s,i,n])})});var ws=h((Hu,vs)=>{"use strict";var gs=u(),Ds="break";vs.exports=gs.extends(Ds,function(e,s,i){gs.apply(this,[Ds,s,i]),this.level=e})});var Ms=h((Ku,Fs)=>{"use strict";var Us=_(),Ps="byref";Fs.exports=Us.extends(Ps,function(e,s,i){Us.apply(this,[Ps,s,i]),this.what=e})});var Hs=h((Vu,Gs)=>{"use strict";var qs=_(),Bs="call";Gs.exports=qs.extends(Bs,function(e,s,i,n){qs.apply(this,[Bs,i,n]),this.what=e,this.arguments=s})});var Qs=h((Wu,Ws)=>{"use strict";var Ks=u(),Vs="case";Ws.exports=Ks.extends(Vs,function(e,s,i,n){Ks.apply(this,[Vs,i,n]),this.test=e,this.body=s})});var js=h((Qu,zs)=>{"use strict";var Ys=R(),$s="cast";zs.exports=Ys.extends($s,function(e,s,i,n,r){Ys.apply(this,[$s,n,r]),this.type=e,this.raw=s,this.expr=i})});var ti=h((Yu,Zs)=>{"use strict";var Xs=u(),Js="catch";Zs.exports=Xs.extends(Js,function(e,s,i,n,r){Xs.apply(this,[Js,n,r]),this.body=e,this.what=s,this.variable=i})});var m=h(($u,ni)=>{"use strict";var ei=u(),si="declaration",Wl="",Ql="public",Yl="protected",$l="private",ii=ei.extends(si,function(e,s,i,n){ei.apply(this,[e||si,i,n]),this.name=s});ii.prototype.parseFlags=function(t){this.isAbstract=t[2]===1,this.isFinal=t[2]===2,this.isReadonly=t[3]===1,this.kind!=="class"&&(t[0]===-1?this.visibility=Wl:t[0]===null?this.visibility=null:t[0]===0?this.visibility=Ql:t[0]===1?this.visibility=Yl:t[0]===2&&(this.visibility=$l),this.isStatic=t[1]===1)};ni.exports=ii});var ai=h((zu,hi)=>{"use strict";var ri=m(),oi="class";hi.exports=ri.extends(oi,function(e,s,i,n,r,o,a){ri.apply(this,[oi,e,o,a]),this.isAnonymous=!e,this.extends=s,this.implements=i,this.body=n,this.attrGroups=[],this.parseFlags(r)})});var ot=h((ju,_i)=>{"use strict";var ci=u(),li="constantstatement";_i.exports=ci.extends(li,function(e,s,i,n){ci.apply(this,[e||li,i,n]),this.constants=s})});var di=h((Xu,Ti)=>{"use strict";var ui=ot(),fi="classconstant",zl="",jl="public",Xl="protected",Jl="private",pi=ui.extends(fi,function(e,s,i,n,r,o,a,c){ui.apply(this,[e||fi,s,a,c]),this.parseFlags(i),this.nullable=n,this.type=r,this.attrGroups=o});pi.prototype.parseFlags=function(t){t[0]===-1?this.visibility=zl:t[0]===null?this.visibility=null:t[0]===0?this.visibility=jl:t[0]===1?this.visibility=Xl:t[0]===2&&(this.visibility=Jl),this.final=t[2]===2};Ti.exports=pi});var Ai=h((Ju,Ei)=>{"use strict";var ki=_(),xi="clone";Ei.exports=ki.extends(xi,function(e,s,i){ki.apply(this,[xi,s,i]),this.what=e})});var Ii=h((Zu,mi)=>{"use strict";var Ni=_(),yi="closure";mi.exports=Ni.extends(yi,function(e,s,i,n,r,o,a,c){Ni.apply(this,[yi,a,c]),this.uses=i,this.arguments=e,this.byref=s,this.type=n,this.nullable=r,this.isStatic=o||!1,this.body=null,this.attrGroups=[]})});var K=h((tf,Li)=>{"use strict";var Ci=p();Li.exports=Ci.extends("comment",function(e,s,i,n){Ci.apply(this,[e,i,n]),this.value=s})});var bi=h((ef,Oi)=>{"use strict";var Si=K(),Ri="commentblock";Oi.exports=Si.extends(Ri,function(e,s,i){Si.apply(this,[Ri,e,s,i])})});var wi=h((sf,vi)=>{"use strict";var gi=K(),Di="commentline";vi.exports=gi.extends(Di,function(e,s,i){gi.apply(this,[Di,e,s,i])})});var Mi=h((nf,Fi)=>{"use strict";var Ui=p(),Pi="constant";Fi.exports=Ui.extends(Pi,function(e,s,i,n){Ui.apply(this,[Pi,i,n]),this.name=e,this.value=s})});var Hi=h((rf,Gi)=>{"use strict";var qi=u(),Bi="continue";Gi.exports=qi.extends(Bi,function(e,s,i){qi.apply(this,[Bi,s,i]),this.level=e})});var Qi=h((of,Wi)=>{"use strict";var Ki=U(),Vi="declare",V=Ki.extends(Vi,function(e,s,i,n,r){Ki.apply(this,[Vi,s,n,r]),this.directives=e,this.mode=i});V.MODE_SHORT="short";V.MODE_BLOCK="block";V.MODE_NONE="none";Wi.exports=V});var ji=h((hf,zi)=>{"use strict";var Yi=p(),$i="declaredirective";zi.exports=Yi.extends($i,function(e,s,i,n){Yi.apply(this,[$i,i,n]),this.key=e,this.value=s})});var tn=h((af,Zi)=>{"use strict";var Xi=u(),Ji="do";Zi.exports=Xi.extends(Ji,function(e,s,i,n){Xi.apply(this,[Ji,i,n]),this.test=e,this.body=s})});var rn=h((cf,nn)=>{"use strict";var en=u(),sn="echo";nn.exports=en.extends(sn,function(e,s,i,n){en.apply(this,[sn,i,n]),this.shortForm=s,this.expressions=e})});var cn=h((lf,an)=>{"use strict";var on=_(),hn="empty";an.exports=on.extends(hn,function(e,s,i){on.apply(this,[hn,s,i]),this.expression=e})});var fn=h((_f,un)=>{"use strict";var ln=C(),_n="encapsed",P=ln.extends(_n,function(e,s,i,n,r){ln.apply(this,[_n,e,s,n,r]),this.type=i});P.TYPE_STRING="string";P.TYPE_SHELL="shell";P.TYPE_HEREDOC="heredoc";P.TYPE_OFFSET="offset";un.exports=P});var kn=h((uf,dn)=>{"use strict";var pn=_(),Tn="encapsedpart";dn.exports=pn.extends(Tn,function(e,s,i,n,r){pn.apply(this,[Tn,n,r]),this.expression=e,this.syntax=s,this.curly=i})});var Nn=h((ff,An)=>{"use strict";var xn=_(),En="entry";An.exports=xn.extends(En,function(e,s,i,n,r,o){xn.apply(this,[En,r,o]),this.key=e,this.value=s,this.byRef=i,this.unpack=n})});var Cn=h((pf,In)=>{"use strict";var yn=m(),mn="enum";In.exports=yn.extends(mn,function(e,s,i,n,r,o){yn.apply(this,[mn,e,r,o]),this.valueType=s,this.implements=i,this.body=n,this.attrGroups=[]})});var On=h((Tf,Rn)=>{"use strict";var Ln=p(),Sn="enumcase";Rn.exports=Ln.extends(Sn,function(e,s,i,n){Ln.apply(this,[Sn,i,n]),this.name=e,this.value=s})});var vn=h((df,Dn)=>{"use strict";var bn=p(),gn="error";Dn.exports=bn.extends(gn,function(e,s,i,n,r,o){bn.apply(this,[gn,r,o]),this.message=e,this.token=s,this.line=i,this.expected=n})});var Fn=h((kf,Pn)=>{"use strict";var wn=_(),Un="eval";Pn.exports=wn.extends(Un,function(e,s,i){wn.apply(this,[Un,s,i]),this.source=e})});var Gn=h((xf,Bn)=>{"use strict";var Mn=_(),qn="exit";Bn.exports=Mn.extends(qn,function(e,s,i,n){Mn.apply(this,[qn,i,n]),this.expression=e,this.useDie=s})});var Wn=h((Ef,Vn)=>{"use strict";var Hn=u(),Kn="expressionstatement";Vn.exports=Hn.extends(Kn,function(e,s,i){Hn.apply(this,[Kn,s,i]),this.expression=e})});var zn=h((Af,$n)=>{"use strict";var Qn=u(),Yn="for";$n.exports=Qn.extends(Yn,function(e,s,i,n,r,o,a){Qn.apply(this,[Yn,o,a]),this.init=e,this.test=s,this.increment=i,this.shortForm=r,this.body=n})});var Zn=h((Nf,Jn)=>{"use strict";var jn=u(),Xn="foreach";Jn.exports=jn.extends(Xn,function(e,s,i,n,r,o,a){jn.apply(this,[Xn,o,a]),this.source=e,this.key=s,this.value=i,this.shortForm=r,this.body=n})});var ht=h((yf,sr)=>{"use strict";var tr=m(),er="function";sr.exports=tr.extends(er,function(e,s,i,n,r,o,a){tr.apply(this,[er,e,o,a]),this.arguments=s,this.byref=i,this.type=n,this.nullable=r,this.body=null,this.attrGroups=[]})});var or=h((mf,rr)=>{"use strict";var ir=u(),nr="global";rr.exports=ir.extends(nr,function(e,s,i){ir.apply(this,[nr,s,i]),this.items=e})});var lr=h((If,cr)=>{"use strict";var hr=u(),ar="goto";cr.exports=hr.extends(ar,function(e,s,i){hr.apply(this,[ar,s,i]),this.label=e})});var pr=h((Cf,fr)=>{"use strict";var _r=u(),ur="halt";fr.exports=_r.extends(ur,function(e,s,i){_r.apply(this,[ur,s,i]),this.after=e})});var xr=h((Lf,kr)=>{"use strict";var Tr=p(),dr="identifier",Zl=Tr.extends(dr,function(e,s,i){Tr.apply(this,[dr,s,i]),this.name=e});kr.exports=Zl});var yr=h((Sf,Nr)=>{"use strict";var Er=u(),Ar="if";Nr.exports=Er.extends(Ar,function(e,s,i,n,r,o){Er.apply(this,[Ar,r,o]),this.test=e,this.body=s,this.alternate=i,this.shortForm=n})});var Lr=h((Rf,Cr)=>{"use strict";var mr=_(),Ir="include";Cr.exports=mr.extends(Ir,function(e,s,i,n,r){mr.apply(this,[Ir,n,r]),this.once=e,this.require=s,this.target=i})});var br=h((Of,Or)=>{"use strict";var Sr=C(),Rr="inline";Or.exports=Sr.extends(Rr,function(e,s,i,n){Sr.apply(this,[Rr,e,s,i,n])})});var wr=h((bf,vr)=>{"use strict";var gr=m(),Dr="interface";vr.exports=gr.extends(Dr,function(e,s,i,n,r,o){gr.apply(this,[Dr,e,r,o]),this.extends=s,this.body=i,this.attrGroups=n})});var Mr=h((gf,Fr)=>{"use strict";var Ur=m(),Pr="intersectiontype";Fr.exports=Ur.extends(Pr,function(e,s,i){Ur.apply(this,[Pr,null,s,i]),this.types=e})});var Hr=h((Df,Gr)=>{"use strict";var qr=_(),Br="isset";Gr.exports=qr.extends(Br,function(e,s,i){qr.apply(this,[Br,s,i]),this.variables=e})});var Qr=h((vf,Wr)=>{"use strict";var Kr=u(),Vr="label";Wr.exports=Kr.extends(Vr,function(e,s,i){Kr.apply(this,[Vr,s,i]),this.name=e})});var jr=h((wf,zr)=>{"use strict";var Yr=_(),$r="list";zr.exports=Yr.extends($r,function(e,s,i,n){Yr.apply(this,[$r,i,n]),this.items=e,this.shortForm=s})});var g=h((Uf,Zr)=>{"use strict";var Xr=_(),Jr="lookup";Zr.exports=Xr.extends(Jr,function(e,s,i,n,r){Xr.apply(this,[e||Jr,n,r]),this.what=s,this.offset=i})});var io=h((Pf,so)=>{"use strict";var to=C(),eo="magic";so.exports=to.extends(eo,function(e,s,i,n){to.apply(this,[eo,e,s,i,n])})});var ho=h((Ff,oo)=>{"use strict";var no=_(),ro="match";oo.exports=no.extends(ro,function(e,s,i,n){no.apply(this,[ro,i,n]),this.cond=e,this.arms=s})});var _o=h((Mf,lo)=>{"use strict";var ao=_(),co="matcharm";lo.exports=ao.extends(co,function(e,s,i,n){ao.apply(this,[co,i,n]),this.conds=e,this.body=s})});var To=h((qf,po)=>{"use strict";var uo=ht(),fo="method";po.exports=uo.extends(fo,function(){uo.apply(this,arguments),this.kind=fo})});var O=h((Bf,Eo)=>{"use strict";var ko=p(),xo="reference",t_=ko.extends(xo,function(e,s,i){ko.apply(this,[e||xo,s,i])});Eo.exports=t_});var mo=h((Gf,yo)=>{"use strict";var Ao=O(),No="name",F=Ao.extends(No,function(e,s,i,n){Ao.apply(this,[No,i,n]),this.name=e.replace(/\\$/,""),this.resolution=s});F.UNQUALIFIED_NAME="uqn";F.QUALIFIED_NAME="qn";F.FULL_QUALIFIED_NAME="fqn";F.RELATIVE_NAME="rn";yo.exports=F});var So=h((Hf,Lo)=>{"use strict";var Io=U(),Co="namespace";Lo.exports=Io.extends(Co,function(e,s,i,n,r){Io.apply(this,[Co,s,n,r]),this.name=e,this.withBrackets=i||!1})});var go=h((Kf,bo)=>{"use strict";var Ro=_(),Oo="namedargument";bo.exports=Ro.extends(Oo,function(e,s,i,n){Ro.apply(this,[Oo,i,n]),this.name=e,this.value=s})});var Uo=h((Vf,wo)=>{"use strict";var Do=_(),vo="new";wo.exports=Do.extends(vo,function(e,s,i,n){Do.apply(this,[vo,i,n]),this.what=e,this.arguments=s})});var qo=h((Wf,Mo)=>{"use strict";var Po=p(),Fo="noop";Mo.exports=Po.extends(Fo,function(e,s){Po.apply(this,[Fo,e,s])})});var Ko=h((Qf,Ho)=>{"use strict";var Bo=C(),Go="nowdoc";Ho.exports=Bo.extends(Go,function(e,s,i,n,r){Bo.apply(this,[Go,e,s,n,r]),this.label=i})});var Yo=h((Yf,Qo)=>{"use strict";var Vo=p(),Wo="nullkeyword";Qo.exports=Vo.extends(Wo,function(e,s,i){Vo.apply(this,[Wo,s,i]),this.raw=e})});var Xo=h(($f,jo)=>{"use strict";var $o=g(),zo="nullsafepropertylookup";jo.exports=$o.extends(zo,function(e,s,i,n){$o.apply(this,[zo,e,s,i,n])})});var eh=h((zf,th)=>{"use strict";var Jo=C(),Zo="number";th.exports=Jo.extends(Zo,function(e,s,i,n){Jo.apply(this,[Zo,e,s,i,n])})});var rh=h((jf,nh)=>{"use strict";var sh=g(),ih="offsetlookup";nh.exports=sh.extends(ih,function(e,s,i,n){sh.apply(this,[ih,e,s,i,n])})});var ch=h((Xf,ah)=>{"use strict";var oh=m(),hh="parameter";ah.exports=oh.extends(hh,function(e,s,i,n,r,o,a,c,l,f){oh.apply(this,[hh,e,l,f]),this.value=i,this.type=s,this.byref=n,this.variadic=r,this.readonly=o,this.nullable=a,this.flags=c||0,this.attrGroups=[]})});var fh=h((Jf,uh)=>{"use strict";var lh=O(),_h="parentreference",e_=lh.extends(_h,function(e,s,i){lh.apply(this,[_h,s,i]),this.raw=e});uh.exports=e_});var kh=h((Zf,dh)=>{"use strict";var ph=R(),Th="post";dh.exports=ph.extends(Th,function(e,s,i,n){ph.apply(this,[Th,i,n]),this.type=e,this.what=s})});var Nh=h((tp,Ah)=>{"use strict";var xh=R(),Eh="pre";Ah.exports=xh.extends(Eh,function(e,s,i,n){xh.apply(this,[Eh,i,n]),this.type=e,this.what=s})});var Ch=h((ep,Ih)=>{"use strict";var yh=_(),mh="print";Ih.exports=yh.extends(mh,function(e,s,i){yh.apply(this,[mh,s,i]),this.expression=e})});var Oh=h((sp,Rh)=>{"use strict";var Lh=U(),Sh="program";Rh.exports=Lh.extends(Sh,function(e,s,i,n,r,o){Lh.apply(this,[Sh,e,r,o]),this.errors=s,i&&(this.comments=i),n&&(this.tokens=n)})});var vh=h((ip,Dh)=>{"use strict";var bh=u(),gh="property";Dh.exports=bh.extends(gh,function(e,s,i,n,r,o,a,c){bh.apply(this,[gh,a,c]),this.name=e,this.value=s,this.readonly=i,this.nullable=n,this.type=r,this.attrGroups=o})});var Fh=h((np,Ph)=>{"use strict";var wh=g(),Uh="propertylookup";Ph.exports=wh.extends(Uh,function(e,s,i,n){wh.apply(this,[Uh,e,s,i,n])})});var Hh=h((rp,Gh)=>{"use strict";var Mh=u(),qh="propertystatement",s_="",i_="public",n_="protected",r_="private",Bh=Mh.extends(qh,function(e,s,i,n,r){Mh.apply(this,[qh,n,r]),this.properties=s,this.parseFlags(i)});Bh.prototype.parseFlags=function(t){t[0]===-1?this.visibility=s_:t[0]===null?this.visibility=null:t[0]===0?this.visibility=i_:t[0]===1?this.visibility=n_:t[0]===2&&(this.visibility=r_),this.isStatic=t[1]===1};Gh.exports=Bh});var Qh=h((op,Wh)=>{"use strict";var Kh=_(),Vh="retif";Wh.exports=Kh.extends(Vh,function(e,s,i,n,r){Kh.apply(this,[Vh,n,r]),this.test=e,this.trueExpr=s,this.falseExpr=i})});var jh=h((hp,zh)=>{"use strict";var Yh=u(),$h="return";zh.exports=Yh.extends($h,function(e,s,i){Yh.apply(this,[$h,s,i]),this.expr=e})});var ta=h((ap,Zh)=>{"use strict";var Xh=O(),Jh="selfreference",o_=Xh.extends(Jh,function(e,s,i){Xh.apply(this,[Jh,s,i]),this.raw=e});Zh.exports=o_});var na=h((cp,ia)=>{"use strict";var ea=_(),sa="silent";ia.exports=ea.extends(sa,function(e,s,i){ea.apply(this,[sa,s,i]),this.expr=e})});var aa=h((lp,ha)=>{"use strict";var ra=u(),oa="static";ha.exports=ra.extends(oa,function(e,s,i){ra.apply(this,[oa,s,i]),this.variables=e})});var ua=h((_p,_a)=>{"use strict";var ca=p(),la="staticvariable";_a.exports=ca.extends(la,function(e,s,i,n){ca.apply(this,[la,i,n]),this.variable=e,this.defaultValue=s})});var da=h((up,Ta)=>{"use strict";var fa=g(),pa="staticlookup";Ta.exports=fa.extends(pa,function(e,s,i,n){fa.apply(this,[pa,e,s,i,n])})});var Aa=h((fp,Ea)=>{"use strict";var ka=O(),xa="staticreference",h_=ka.extends(xa,function(e,s,i){ka.apply(this,[xa,s,i]),this.raw=e});Ea.exports=h_});var Ia=h((pp,ma)=>{"use strict";var Na=C(),ya="string";ma.exports=Na.extends(ya,function(e,s,i,n,r,o){Na.apply(this,[ya,s,n,r,o]),this.unicode=i,this.isDoubleQuote=e})});var Ra=h((Tp,Sa)=>{"use strict";var Ca=u(),La="switch";Sa.exports=Ca.extends(La,function(e,s,i,n,r){Ca.apply(this,[La,n,r]),this.test=e,this.body=s,this.shortForm=i})});var Da=h((dp,ga)=>{"use strict";var Oa=u(),ba="throw";ga.exports=Oa.extends(ba,function(e,s,i){Oa.apply(this,[ba,s,i]),this.what=e})});var Pa=h((kp,Ua)=>{"use strict";var va=m(),wa="trait";Ua.exports=va.extends(wa,function(e,s,i,n){va.apply(this,[wa,e,i,n]),this.body=s})});var Ba=h((xp,qa)=>{"use strict";var Fa=p(),Ma="traitalias",a_="",c_="public",l_="protected",__="private";qa.exports=Fa.extends(Ma,function(e,s,i,n,r,o){Fa.apply(this,[Ma,r,o]),this.trait=e,this.method=s,this.as=i,this.visibility=a_,n&&(n[0]===0?this.visibility=c_:n[0]===1?this.visibility=l_:n[0]===2&&(this.visibility=__))})});var Va=h((Ep,Ka)=>{"use strict";var Ga=p(),Ha="traitprecedence";Ka.exports=Ga.extends(Ha,function(e,s,i,n,r){Ga.apply(this,[Ha,n,r]),this.trait=e,this.method=s,this.instead=i})});var $a=h((Ap,Ya)=>{"use strict";var Wa=p(),Qa="traituse";Ya.exports=Wa.extends(Qa,function(e,s,i,n){Wa.apply(this,[Qa,i,n]),this.traits=e,this.adaptations=s})});var Ja=h((Np,Xa)=>{"use strict";var za=u(),ja="try";Xa.exports=za.extends(ja,function(e,s,i,n,r){za.apply(this,[ja,n,r]),this.body=e,this.catches=s,this.always=i})});var ic=h((yp,sc)=>{"use strict";var Za=O(),tc="typereference",ec=Za.extends(tc,function(e,s,i,n){Za.apply(this,[tc,i,n]),this.name=e,this.raw=s});ec.types=["int","float","string","bool","object","array","callable","iterable","void","static"];sc.exports=ec});var hc=h((mp,oc)=>{"use strict";var nc=R(),rc="unary";oc.exports=nc.extends(rc,function(e,s,i,n){nc.apply(this,[rc,i,n]),this.type=e,this.what=s})});var _c=h((Ip,lc)=>{"use strict";var ac=m(),cc="uniontype";lc.exports=ac.extends(cc,function(e,s,i){ac.apply(this,[cc,null,s,i]),this.types=e})});var Tc=h((Cp,pc)=>{"use strict";var uc=u(),fc="unset";pc.exports=uc.extends(fc,function(e,s,i){uc.apply(this,[fc,s,i]),this.variables=e})});var Ec=h((Lp,xc)=>{"use strict";var dc=u(),kc="usegroup";xc.exports=dc.extends(kc,function(e,s,i,n,r){dc.apply(this,[kc,n,r]),this.name=e,this.type=s,this.items=i})});var mc=h((Sp,yc)=>{"use strict";var Ac=u(),Nc="useitem",at=Ac.extends(Nc,function(e,s,i,n,r){Ac.apply(this,[Nc,n,r]),this.name=e,this.alias=s,this.type=i});at.TYPE_CONST="const";at.TYPE_FUNCTION="function";yc.exports=at});var Sc=h((Rp,Lc)=>{"use strict";var Ic=_(),Cc="variable";Lc.exports=Ic.extends(Cc,function(e,s,i,n){Ic.apply(this,[Cc,i,n]),this.name=e,this.curly=s||!1})});var gc=h((Op,bc)=>{"use strict";var Rc=_(),Oc="variadic";bc.exports=Rc.extends(Oc,function(e,s,i){Rc.apply(this,[Oc,s,i]),this.what=e})});var Uc=h((bp,wc)=>{"use strict";var Dc=p(),vc="variadicplaceholder";wc.exports=Dc.extends(vc,function(e,s){Dc.apply(this,[vc,e,s])})});var qc=h((gp,Mc)=>{"use strict";var Pc=u(),Fc="while";Mc.exports=Pc.extends(Fc,function(e,s,i,n,r){Pc.apply(this,[Fc,n,r]),this.test=e,this.body=s,this.shortForm=i})});var Kc=h((Dp,Hc)=>{"use strict";var Bc=_(),Gc="yield";Hc.exports=Bc.extends(Gc,function(e,s,i,n){Bc.apply(this,[Gc,i,n]),this.value=e,this.key=s})});var Yc=h((vp,Qc)=>{"use strict";var Vc=_(),Wc="yieldfrom";Qc.exports=Vc.extends(Wc,function(e,s,i){Vc.apply(this,[Wc,s,i]),this.value=e})});var zc=h((wp,$c)=>{"use strict";var u_=Pe(),f_=it(),x=function(t,e){this.withPositions=t,this.withSource=e};x.precedence={};[["or"],["xor"],["and"],["="],["?"],["??"],["||"],["&&"],["|"],["^"],["&"],["==","!=","===","!==","<=>"],["<","<=",">",">="],["<<",">>"],["+","-","."],["*","/","%"],["!"],["instanceof"],["cast","silent"],["**"]].forEach(function(t,e){t.forEach(function(s){x.precedence[s]=e+1})});x.prototype.isRightAssociative=function(t){return t==="**"||t==="??"};x.prototype.swapLocations=function(t,e,s,i){this.withPositions&&(t.loc.start=e.loc.start,t.loc.end=s.loc.end,this.withSource&&(t.loc.source=i.lexer._input.substring(t.loc.start.offset,t.loc.end.offset)))};x.prototype.resolveLocations=function(t,e,s,i){this.withPositions&&(t.loc.start.offset>e.loc.start.offset&&(t.loc.start=e.loc.start),t.loc.end.offset<s.loc.end.offset&&(t.loc.end=s.loc.end),this.withSource&&(t.loc.source=i.lexer._input.substring(t.loc.start.offset,t.loc.end.offset)))};x.prototype.resolvePrecedence=function(t,e){let s,i,n;return t.kind==="call"?this.resolveLocations(t,t.what,t,e):t.kind==="propertylookup"||t.kind==="staticlookup"||t.kind==="offsetlookup"&&t.offset?this.resolveLocations(t,t.what,t.offset,e):t.kind==="bin"?t.right&&!t.right.parenthesizedExpression&&(t.right.kind==="bin"?(i=x.precedence[t.type],n=x.precedence[t.right.type],i&&n&&n<=i&&(t.type!==t.right.type||!this.isRightAssociative(t.type))&&(s=t.right,t.right=t.right.left,this.swapLocations(t,t.left,t.right,e),s.left=this.resolvePrecedence(t,e),this.swapLocations(s,s.left,s.right,e),t=s)):t.right.kind==="retif"&&(i=x.precedence[t.type],n=x.precedence["?"],i&&n&&n<=i&&(s=t.right,t.right=t.right.test,this.swapLocations(t,t.left,t.right,e),s.test=this.resolvePrecedence(t,e),this.swapLocations(s,s.test,s.falseExpr,e),t=s))):(t.kind==="silent"||t.kind==="cast")&&t.expr&&!t.expr.parenthesizedExpression?t.expr.kind==="bin"?(s=t.expr,t.expr=t.expr.left,this.swapLocations(t,t,t.expr,e),s.left=this.resolvePrecedence(t,e),this.swapLocations(s,s.left,s.right,e),t=s):t.expr.kind==="retif"&&(s=t.expr,t.expr=t.expr.test,this.swapLocations(t,t,t.expr,e),s.test=this.resolvePrecedence(t,e),this.swapLocations(s,s.test,s.falseExpr,e),t=s):t.kind==="unary"?t.what&&!t.what.parenthesizedExpression&&(t.what.kind==="bin"?(s=t.what,t.what=t.what.left,this.swapLocations(t,t,t.what,e),s.left=this.resolvePrecedence(t,e),this.swapLocations(s,s.left,s.right,e),t=s):t.what.kind==="retif"&&(s=t.what,t.what=t.what.test,this.swapLocations(t,t,t.what,e),s.test=this.resolvePrecedence(t,e),this.swapLocations(s,s.test,s.falseExpr,e),t=s)):t.kind==="retif"?t.falseExpr&&t.falseExpr.kind==="retif"&&!t.falseExpr.parenthesizedExpression&&(s=t.falseExpr,t.falseExpr=s.test,this.swapLocations(t,t.test,t.falseExpr,e),s.test=this.resolvePrecedence(t,e),this.swapLocations(s,s.test,s.falseExpr,e),t=s):t.kind==="assign"?t.right&&t.right.kind==="bin"&&!t.right.parenthesizedExpression&&(i=x.precedence["="],n=x.precedence[t.right.type],i&&n&&n<i&&(s=t.right,t.right=t.right.left,s.left=t,this.swapLocations(s,s.left,t.right,e),t=s)):t.kind==="expressionstatement"&&this.swapLocations(t,t.expression,t,e),t};x.prototype.prepare=function(t,e,s){let i=null;(this.withPositions||this.withSource)&&(i=s.position());let n=this,r=function(){let o=null,a=Array.prototype.slice.call(arguments);if(a.push(e),n.withPositions||n.withSource){let f=null;n.withSource&&(f=s.lexer._input.substring(i.offset,s.prev[2])),o=new u_(f,i,new f_(s.prev[0],s.prev[1],s.prev[2])),a.push(o)}t||(t=a.shift());let c=n[t];if(typeof c!="function")throw new Error('Undefined node "'+t+'"');let l=Object.create(c.prototype);return c.apply(l,a),r.instance=l,r.trailingComments&&(l.trailingComments=r.trailingComments),typeof r.postBuild=="function"&&r.postBuild(l),s.debug&&delete n.stack[r.stackUid],n.resolvePrecedence(l,s)};return s.debug&&(this.stack||(this.stack={},this.stackUid=1),this.stack[++this.stackUid]={position:i,stack:new Error().stack.split(`
`).slice(3,5)},r.stackUid=this.stackUid),r.setTrailingComments=function(o){r.instance?r.instance.setTrailingComments(o):r.trailingComments=o},r.destroy=function(o){e&&(o?o.leadingComments?o.leadingComments=e.concat(o.leadingComments):o.leadingComments=e:s._docIndex=s._docs.length-e.length),s.debug&&delete n.stack[r.stackUid]},r};x.prototype.checkNodes=function(){let t=[];for(let e in this.stack)Object.prototype.hasOwnProperty.call(this.stack,e)&&(this.stack[e].key=e,t.push(this.stack[e]));return this.stack={},t};[Ve(),$e(),Je(),ss(),os(),ls(),ks(),U(),bs(),ws(),Ms(),Hs(),Qs(),js(),ti(),ai(),di(),Ai(),Ii(),K(),bi(),wi(),Mi(),ot(),Hi(),m(),Qi(),ji(),tn(),rn(),cn(),fn(),kn(),Nn(),Cn(),On(),vn(),Fn(),Gn(),_(),Wn(),zn(),Zn(),ht(),or(),lr(),pr(),xr(),yr(),Lr(),br(),wr(),Mr(),Hr(),Qr(),jr(),C(),g(),io(),ho(),_o(),To(),mo(),So(),go(),Uo(),p(),qo(),Ko(),Yo(),Xo(),eh(),rh(),R(),ch(),fh(),kh(),Nh(),Ch(),Oh(),vh(),Fh(),Hh(),O(),Qh(),jh(),ta(),na(),u(),aa(),ua(),da(),Aa(),Ia(),Ra(),Da(),Pa(),Ba(),Va(),$a(),Ja(),ic(),hc(),_c(),Tc(),Ec(),mc(),Sc(),gc(),Uc(),qc(),Kc(),Yc()].forEach(function(t){x.prototype[t.kind]=t});$c.exports=x});var tl=h((Up,L)=>{"use strict";var jc=zt(),Xc=ge(),Jc=we(),Zc=zc();function ct(t,e){let s=Object.keys(t),i=s.length;for(;i--;){let n=s[i],r=t[n];r===null?delete e[n]:typeof r=="function"?e[n]=r.bind(e):Array.isArray(r)?e[n]=Array.isArray(e[n])?e[n].concat(r):r:typeof r=="object"?e[n]=typeof e[n]=="object"?ct(r,e[n]):r:e[n]=r}return e}var E=function(t){if(typeof this=="function")return new this(t);if(this.tokens=Jc,this.lexer=new jc(this),this.ast=new Zc,this.parser=new Xc(this.lexer,this.ast),t&&typeof t=="object"){if(t.parser&&(t.lexer||(t.lexer={}),t.parser.version)){if(typeof t.parser.version=="string"){let e=t.parser.version.split(".");if(e=parseInt(e[0])*100+parseInt(e[1]),isNaN(e))throw new Error("Bad version number : "+t.parser.version);t.parser.version=e}else if(typeof t.parser.version!="number")throw new Error("Expecting a number for version");if(t.parser.version<500||t.parser.version>900)throw new Error("Can only handle versions between 5.x to 8.x")}ct(t,this),this.lexer.version=this.parser.version}},lt=function(t){return typeof t.write=="function"?t.toString():t};E.create=function(t){return new E(t)};E.parseEval=function(t,e){return new E(e).parseEval(t)};E.prototype.parseEval=function(t){return this.lexer.mode_eval=!0,this.lexer.all_tokens=!1,t=lt(t),this.parser.parse(t,"eval")};E.parseCode=function(t,e,s){return typeof e=="object"&&!s&&(s=e,e="unknown"),new E(s).parseCode(t,e)};E.prototype.parseCode=function(t,e){return this.lexer.mode_eval=!1,this.lexer.all_tokens=!1,t=lt(t),this.parser.parse(t,e)};E.tokenGetAll=function(t,e){return new E(e).tokenGetAll(t)};E.prototype.tokenGetAll=function(t){this.lexer.mode_eval=!1,this.lexer.all_tokens=!0,t=lt(t);let e=this.lexer.EOF,s=this.tokens.values;this.lexer.setInput(t);let i=this.lexer.lex()||e,n=[];for(;i!=e;){let r=this.lexer.yytext;Object.prototype.hasOwnProperty.call(s,i)&&(r=[s[i],r,this.lexer.yylloc.first_line]),n.push(r),i=this.lexer.lex()||e}return n};L.exports=E;L.exports.tokens=Jc;L.exports.lexer=jc;L.exports.AST=Zc;L.exports.parser=Xc;L.exports.combine=ct;L.exports.Engine=E;L.exports.default=E});var cl=h(B=>{var nl=tl(),{CodeAction:rl,CodeActionKind:W,Position:ol,workspace:q,WorkspaceEdit:pt,window:y}=require("vscode"),{ask:hl}=X();function _t(t,e,s){if(t.kind==="assign"&&t.left.loc&&t.left.loc.end.offset<=e&&t.right.loc&&t.right.loc.start.offset>=e||t.kind==="bin"&&t.loc&&t.loc.end.offset>=e&&t.loc.end.offset>s&&t.loc.start.offset<=s&&t.loc.start.offset<e)return!0;if(t.loc&&t.loc.start.offset>s)return!1;for(let i in t){let n=t[i];if(Array.isArray(n)){for(let r of n)if(r&&typeof r=="object"){let o=_t(r,e,s);if(o)return o}}else if(n&&typeof n=="object"){let r=_t(n,e,s);if(r)return r}}return!1}function ut(t,e,s){if(t.kind==="method"&&t.loc&&t.loc.start.offset<=e&&t.loc.end.offset>=s)return t;if(t.loc&&t.loc.start.offset>s)return null;for(let i in t){let n=t[i];if(Array.isArray(n)){for(let r of n)if(r&&typeof r=="object"){let o=ut(r,e,s);if(o)return o}}else if(n&&typeof n=="object"){let r=ut(n,e,s);if(r)return r}}return null}function M(t,e){t.kind&&e(t);for(let s in t){let i=t[s];if(Array.isArray(i))for(let n of i)M(n,e);else i&&typeof i=="object"&&M(i,e)}}function el(t,e=0){let s=[];return M(t,i=>{i.kind==="variable"&&typeof i.name=="string"&&i.name!=="this"&&i.loc&&i.loc.start.offset>e&&!s.includes(i.name)&&s.push(i.name)}),s}function sl(t,e=0){let s=[];return M(t,i=>{if(e>0&&i.loc&&i.loc.end.offset>e)return;let n=[];i.kind==="parameter"?n.push(i.name):["assign","assignop","assignref"].includes(i.kind)?i.left?.kind==="variable"?n.push(i.left):i.left.kind==="list"?i.left.items.forEach(r=>{n.push(r.value)}):i.left.kind==="array"&&i.left.items.forEach(r=>{n.push(r)}):(i.kind==="post"||i.kind==="pre")&&n.push(i.what);for(let r of n)r&&(r.kind==="variable"||r.kind==="identifier")&&typeof r.name=="string"&&!s.includes(r.name)&&s.push(r.name)}),s}function p_(t){let e=!0,s=4;if(y.visibleTextEditors.find(n=>n.document.uri.toString()===t.uri.toString()))e=y.activeTextEditor.options.insertSpaces,s=y.activeTextEditor.options.tabSize;else{let n=q.getConfiguration("editor",{languageId:"php"});e=n.get("insertSpaces",!0),s=n.get("tabSize",4)}return e?" ".repeat(Number(s)):"	"}function Q(t){return t.map(e=>"$"+e).join(", ")}function T_(t,e,s,i){let n="";return s.length===1?n=`$${s[0]} = `:s.length>1&&(n="["+Q(s)+"] = "),n+"$this->"+t+"("+Q(e)+")"+(i?"":";")}function d_(t,e,s,i,n,r){let o=`
${i}`,a=Q(e),c=`private function ${t}(${a})`,l=`: void${o}`,f="",T="";if(r)l=" ",f="return ",T=n.substring(n.length-1)!==";"?";":"";else if(s.length===1)l=" ",T=`${o}${i}return $${s[0]};`;else if(s.length>1){l=`: array${o}`;let N=Q(s);T=`${o}${i}return [${N}];`}return`${o}${c}${l}{${o}${i}${f}${n}${T}${o}}
`}function k_(t,e,s){let i=null;return M(t,n=>{n.loc&&n.loc.start.offset<=e&&n.loc.end.offset>=s&&["expressionstatement","return","if","foreach","for","while","dowhile","switch","throw"].includes(n.kind)&&(i=n)}),i}function al(t){let e=["if","else","return","throw","try","catch","finally",";","{","}"],s=t.toLowerCase();return!e.some(i=>s.includes(i))}function x_(t){let e=t.match(/^(\s*)/);return e?e[1]:""}function il(t,e,s,i){let n=new rl(t,W.RefactorExtract);return n.command={title:t,command:e,arguments:[s,i]},n}function E_(t,e,s,i){let n=new rl(t,W.RefactorRewrite);return n.command={title:t,command:e,arguments:[s,i]},n}function Tt(t,e){if(t&&e)return[t,e];if(y.activeTextEditor)return[y.activeTextEditor.document,y.activeTextEditor.selection]}function A_(t,e){if([t,e]=Tt(t,e),!t||e.isEmpty)return;let s=new nl.Engine({ast:{withPositions:!0}}),i=t.offsetAt(e.start),n=t.offsetAt(e.end),r=ut(s.parseCode(t.getText()),i,n);if(!r){y.showErrorMessage("Extract method : unable to locate parent method");return}let o=t.getText(e).trim(),a=null;try{a=s.parseCode("<?php "+o)}catch{y.showErrorMessage("Extract method : invalid selection");return}let c=sl(a),l=sl(r,i),f=el(a).filter(I=>l.includes(I)),T=el(r,n).filter(I=>c.includes(I)),N=_t(r,i,n);if(N&&T.length>0){y.showErrorMessage("Extract method : more than one returned variable in assignment");return}let A=o.substring(o.length-1)===";";hl("Method name").then(async I=>{if(I===void 0||I.length<1)return;let ml=new ol(r.loc.end.line,0),$=new pt;$.insert(t.uri,ml,d_(I,f,T,p_(t),o,N)),$.replace(t.uri,e,T_(I,f,T,N&&!A)),await q.applyEdit($)})}async function N_(t,e){if([t,e]=Tt(t,e),!t||e.isEmpty)return;let s=t.getText(e).trim();if(!al(s)){y.showErrorMessage("Extract variable : invalid selection");return}let n=new nl.Engine({ast:{withPositions:!0}}).parseCode(t.getText()),r=k_(n,t.offsetAt(e.start),t.offsetAt(e.end));if(!r){y.showErrorMessage("Extract variable : invalid selection");return}hl("Variable name").then(async o=>{if(!o)return;let a=r.loc.start.line-1,c=x_(t.lineAt(a).text)+"$"+o+" = "+s+`;
`,l=new pt;l.insert(t.uri,new ol(a,0),c),l.replace(t.uri,e,"$"+o),await q.applyEdit(l)})}async function y_(t,e){if([t,e]=Tt(t,e),!t)return;let s=t.getText(e).trim(),i=s.replaceAll(/\s+/g," ");if(s!==i){let n=new pt;n.replace(t.uri,e,i),await q.applyEdit(n)}}var ft=class{static providedCodeActionKinds=[W.RefactorExtract,W.RefactorRewrite];provideCodeActions(e,s,i,n){if(s.isEmpty)return[];let r=e.getText(s).trim(),o=q.getConfiguration("phpcompanion"),a=[];return o.get("activate.refactor.extractVariable",!0)&&al(r)&&a.push(il("Extract to variable","phpcompanion.extractVariable",e,s)),o.get("activate.refactor.extractMethod",!0)&&a.push(il("Extract to method","phpcompanion.extractMethod",e,s)),o.get("activate.refactor.inlineCode",!0)&&r.match(/\s{2}/)&&a.push(E_("Inline code","phpcompanion.inlineCode",e,s)),a}};B.extractMethod=A_;B.extractVariable=N_;B.inlineCode=y_;B.RefactorProvider=ft});var _l=h(ll=>{var{commands:m_,Uri:I_,window:Y,workspace:dt}=require("vscode"),kt=class{#t;#s;#e;#n;#i="";constructor(e,s,i,n){this.#t=e,this.#s=s,this.#e=i,this.#n=n}run(){let e=this.detectPath();if(e===""){Y.showErrorMessage("Cannot run tests : no folder selected");return}this.#t.update("running"),this.#s.run(e,s=>this.handle(e,s))}detectPath(){if(Y.activeTextEditor){let e=Y.activeTextEditor.document.uri,s=dt.getWorkspaceFolder(e);if(s)return s.uri.fsPath}return this.#i!==""?this.#i:dt.workspaceFolders[0]?dt.workspaceFolders[0].uri.fsPath:""}async handle(e,s){this.#n.onDidChangeEmitter.fire(I_.parse("phpcompanion:Tests")),this.#i=e;let i=this.#e.scan(this.#s.output);if(s!==0&&!i){this.#t.update("error"),await Y.showErrorMessage("Error running tests","Open logs","Close")==="Open logs"&&m_.executeCommand("phpcompanion.openLogs");return}this.#t.update("done",i)}};ll.TestsRunner=kt});var fl=h(ul=>{var{StatusBarAlignment:C_,window:L_}=require("vscode"),xt=class{#t;constructor(){this.#t=L_.createStatusBarItem(C_.Left)}changeActionToOpenLogs(e){this.#t.command="phpcompanion.openLogs",this.#t.tooltip=e+". Click to show tests logs",this.#t.show()}changeActionToRunTests(e){this.#t.command="phpcompanion.runTests",this.#t.tooltip=(e?e+". ":"")+"Click to run tests",this.#t.show()}update(e,s){if(this.changeActionToRunTests(),!e){this.#t.text="$(beaker) Ready";return}if(e==="running"){this.#t.text="$(beaker) Running";return}if(e==="error"){this.#t.text="$(beaker) $(error) Error",this.changeActionToOpenLogs("Error running tests");return}if(!s||!s.tests){this.#t.text="$(beaker) No stats",this.changeActionToOpenLogs("Cannot analyse logs");return}if(s.failures>0){this.#t.text=`$(beaker) ${s.assertions} $(error) ${s.failures}`,this.changeActionToOpenLogs(`${s.tests} tests, ${s.assertions} assertions, ${s.failures} failures`);return}this.#t.text=`$(beaker) ${s.assertions} $(pass)`,this.changeActionToRunTests(`${s.tests} tests, ${s.assertions} assertions`)}};ul.TestsStatusBar=xt});var Tl=h(pl=>{var{spawn:S_}=require("child_process"),{workspace:R_}=require("vscode"),Et=class{#t;#s=!1;#e="";storeOutput(e){this.#e+=e.toString().replace(`\r
`,`
`).replace("\r",`
`)}get output(){return this.#e}run(e,s){this.#e="",this.#s=!1;let i=R_.getConfiguration("phpcompanion"),n=i.get("tests.script","");if(n==""){this.#e="Error : no tests script. Please set in settings";return}let r=i.get("tests.scriptArguments",[]);if(this.#e="> "+n+" "+r.join(" ")+`

`,this.#t=S_(n,r,{cwd:e}),!this.#t){this.#e+="Cannot start process";return}this.#t.stdout.on("data",o=>{this.storeOutput(o)}),this.#t.stderr.on("data",o=>{this.storeOutput(o)}),this.#t.on("error",o=>{this.#s=!0,this.storeOutput(o.message.replace("ENOENT",": no such file or directory")),s(1)}),this.#t.on("close",o=>{this.#s||s(o)})}};pl.Process=Et});var kl=h(dl=>{var{DocumentLink:O_,EventEmitter:b_,Range:g_,Uri:D_}=require("vscode"),At=class{onDidChangeEmitter=new b_;#t;constructor(e){this.#t=e}onDidChange=this.onDidChangeEmitter.event;provideTextDocumentContent(e){if(e.path==="Tests")return this.#t?this.#t.output:""}provideDocumentLinks(e,s){let i=[],n=e.getText().split(`
`);for(let r=0;r<n.length;r++){let o=n[r];Array.from(o.matchAll(/(?<url>[^\s]*\/[^(:`\s]+)([(:](?<line>\d+)\)?)?/g)).forEach(a=>{let c=a[0],l=o.indexOf(c),f=a.groups.line?{fragment:a.groups.line-1}:{},T=new g_(r,l,r,l+c.length),N=D_.file(a.groups.url).with(f);i.push(new O_(T,N))})}return i}};dl.DocumentProvider=At});var El=h(xl=>{var Nt=class{scan(e){let s=e.split(`
`).map(n=>n.match(/Tests: (?<tests>\d+)[^,\.]*(, Assertions: (?<assertions>\d+)[^,\.]*)?(, Failures: (?<failures>\d+)[^,\.]*)?(, Errors: (?<errors>\d+)[^,\.]*)?(, Skipped: (?<skipped>\d+)[^,\.]*)?/)||n.match(/(OK )?\((?<tests>\d+) tests?, (?<assertions>\d+) assertions?\)/)).filter(n=>n!==null).pop();if(!s||!s.groups.tests)return;let i=0;return s.groups.failures&&(i+=parseInt(s.groups.failures)),s.groups.errors&&(i+=parseInt(s.groups.errors)),{tests:parseInt(s.groups.tests),assertions:parseInt(s.groups.assertions),failures:i}}};xl.PHPUnitParser=Nt});var{commands:b,languages:Al,Uri:v_,window:w_,workspace:Nl}=require("vscode"),{createPHPFile:U_,replaceSelectionWithNamespace:P_}=St(),{RefactorProvider:yl,extractMethod:F_,extractVariable:M_,inlineCode:q_}=cl(),{TestsRunner:B_}=_l(),{TestsStatusBar:G_}=fl(),{Process:H_}=Tl(),{DocumentProvider:K_}=kl(),{PHPUnitParser:V_}=El();function W_(t){let e=Nl.getConfiguration("phpcompanion");if(e.get("activate.createPHPFile",!0)&&t.subscriptions.push(b.registerCommand("phpcompanion.newPHPClass",s=>U_(s))),e.get("activate.refactor.extractMethod",!0)&&t.subscriptions.push(b.registerCommand("phpcompanion.extractMethod",F_)),e.get("activate.refactor.extractVariable",!0)&&t.subscriptions.push(b.registerCommand("phpcompanion.extractVariable",M_)),e.get("activate.refactor.inlineCode",!0)&&t.subscriptions.push(b.registerCommand("phpcompanion.inlineCode",q_)),(e.get("activate.refactor.extractMethod",!0)||e.get("activate.refactor.extractVariable",!0)||e.get("activate.refactor.inlineCode",!0))&&t.subscriptions.push(Al.registerCodeActionsProvider("php",new yl,{providedCodeActionKinds:yl.providedCodeActionKinds})),e.get("activate.insertNamespace",!0)&&t.subscriptions.push(b.registerCommand("phpcompanion.insertNamespace",P_)),e.get("activate.runTests",!0)){let s=new G_,i=new H_,n=new K_(i),r=new B_(s,i,new V_,n);t.subscriptions.push(b.registerCommand("phpcompanion.runTests",()=>r.run()),b.registerCommand("phpcompanion.openLogs",Y_),s,Nl.registerTextDocumentContentProvider("phpcompanion",n),Al.registerDocumentLinkProvider({scheme:"phpcompanion"},n))}}function Q_(){}async function Y_(){await w_.showTextDocument(v_.parse("phpcompanion:Tests"),{preview:!1})}exports.activate=W_;exports.deactivate=Q_;
